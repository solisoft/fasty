!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},a={},i={},s={}.hasOwnProperty,o=/^\.\.?(\/|$)/,n=function(t,e){for(var a,i=[],s=(o.test(e)?t+"/"+e:e).split("/"),n=0,d=s.length;n<d;n++)a=s[n],".."===a?i.pop():"."!==a&&""!==a&&i.push(a);return i.join("/")},d=function(t){return t.split("/").slice(0,-1).join("/")},l=function(e){return function(a){var i=n(d(e),a);return t.require(i,e)}},r=function(t,e){var i=g&&g.createHot(t),s={id:t,exports:{},hot:i};return a[t]=s,e(s.exports,l(t),s),s.exports},c=function(t){var e=i[t];return e&&t!==e?c(e):t},u=function(t,e){return c(n(d(t),e))},m=function(t,i){null==i&&(i="/");var o=c(t);if(s.call(a,o))return a[o].exports;if(s.call(e,o))return r(o,e[o]);throw new Error("Cannot find module '"+t+"' from '"+i+"'")};m.alias=function(t,e){i[e]=t};var f=/\.[^.\/]+$/,p=/\/index(\.[^\/]+)?$/,h=function(t){if(f.test(t)){var e=t.replace(f,"");s.call(i,e)&&i[e].replace(f,"")!==e+"/index"||(i[e]=t)}if(p.test(t)){var a=t.replace(p,"");s.call(i,a)||(i[a]=t)}};m.register=m.define=function(t,i){if(t&&"object"==typeof t)for(var o in t)s.call(t,o)&&m.register(o,t[o]);else e[t]=i,delete a[t],h(t)},m.list=function(){var t=[];for(var a in e)s.call(e,a)&&t.push(a);return t};var g=t._hmr&&new t._hmr(u,m,e,a);m._cache=a,m.hmr=g&&g.wrap,m.brunch=!0,t.require=m}}(),function(){var t;"undefined"==typeof window?this:window;require.register("index.html",function(t,e,a){}),require.register("js/common.js",function(t,e,a){var i={init:function(){$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}},startEditor:function(t,e,a){var i=ace.edit(t);i.setTheme("ace/theme/twilight"),i.getSession().setMode(e),i.setOptions({tabSize:2,useSoftTabs:!0}),i.getSession().setUseWrapMode(!0),i.getSession().setValue(unescape($("#"+a).val())),i.getSession().on("change",function(){$("#"+a).val(i.getSession().getValue())})},checkConditions:function(t,e){_.each(t,function(t){t["if"]&&($("#"+t["if"][0]).val()!=t["if"][1]?$("#field_"+t.n).hide():$("#field_"+t.n).show())})},buildForm:function(t,e,a,i,s){var o="",n=[],d=this,l=[],r=[],c=[],u=[],m=[],f=!1,p=[],h="",g=0,v="";if(e.forEach(function(e,a){if(e.tab)g>0&&(o+="</div>"),0==f&&(o+="<ul uk-tab>"),0==f&&(p=[]),f=!0,o+='<li><a href="#">'+e.tab+"</a></li>",""!=o&&(p.push(v),v=""),h=e.id,g=0;else if(void 0!==e.h)v+='<div class="uk-grid uk-grid-small uk-margin-top"><h3>'+e.h+"</h3></div>";else{e.r&&g>0&&(v+="</div>"),e.r&&(v+='<div class="uk-grid uk-grid-small">'),e.c&&e.c.indexOf("uk-width")==-1&&(e.c="uk-width-"+e.c);var i=e.j;t._key&&e.ju&&(i=e.ju);var s="";"hidden"===e.t&&(s="uk-hidden"),v+='<div class="'+e.c+" "+s+'" id="field_'+e.n+'">';var d=e.l;_.isString(i)?i.indexOf("required")>0&&(d="<strong>"+d+"*</strong>"):i&&"required"===i._flags.presence&&(d="<strong>"+d+"*</strong>"),("file"!==e.t&&"image"!==e.t||void 0!==t._id)&&(v+='<label for="" class="uk-form-label">'+d+"</label>");var b=t[e.n];if(e.tr&&t[e.n]&&(b=t[e.n][window.localStorage.getItem("foxx-locale")]),void 0===b&&(b=""),e.t.match(/string/)&&(v+='<input type="'+(2==e.t.split(":").length?e.t.split(":")[1]:"text")+'" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,b])),e.t.match(/password/)&&(v+='<input type="password" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>'),"integer"===e.t&&(v+='<input type="number" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="'+b+'" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,b])),"float"===e.t&&(v+='<input type="text" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="'+b+'" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,b])),"hidden"===e.t&&(v+='<input type="hidden" id="'+e.n+'"  name="'+e.n+'"  value="'+b+'"></div><div data-hint="'+e.n+'">'),"date"===e.t&&(v+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="date" id="'+e.n+'" data-date-format="YYYY/MM/DD" class="uk-input" name="'+e.n+'"  value="'+b+'"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"datetime"===e.t&&(b=b.replace(":00.000",""),v+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="text" id="'+e.n+'" class="uk-input datepicker-here" data-language="en" name="'+e.n+'"  value="'+b+'" autocomplete="off"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"time"===e.t&&(v+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="time" id="'+e.n+'" class="uk-input" name="'+e.n+'"  value="'+b+'"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"text"===e.t&&(v+='<textarea id="'+e.n+'" class="uk-textarea" name="'+e.n+'" style="'+e.s+'">'+b+'</textarea><div data-hint="'+e.n+'" class="uk-text-danger"></div>'),"wysiwyg"===e.t&&(u.push(e.n),v+='<textarea id="'+e.n+'" name="'+e.n+'" ></textarea><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,b])),e.t.match(/^code/)&&(v+='<input type="hidden" id="'+e.n+'" name="'+e.n+'" value="">',r.push([e.n,b]),v+='<div id="editor_'+e.n+'" class="editor" style="'+e.s+'"></div>',l.push(["editor_"+e.n,"ace/mode/"+e.t.split(":")[1],e.n])),"html"==e.t&&(v+='<input type="hidden" id="'+e.n+'" name="'+e.n+'" value="">',v+='<div id="html_editor_'+e.n+'" data-name="'+e.n+'" class="html_editor" style="'+e.s+'"></div>',m.push([e.n,b])),"list"===e.t&&(v+='<select name="'+e.n+'" style="width:100%" class="uk-select select_list" id="'+e.n+'">',e.empty===!0&&(v+='<option value="">--</option>'),e.d.forEach(function(t){selected="",b===t[0]&&(selected="selected='selected'"),v+='<option value="'+t[0]+'" '+selected+">"+t[1]+"</option>"}),v+="</select>"),"multilist"===e.t&&(v+='<select name="'+e.n+'" style="width:100%" class="uk-select select_mlist" multiple="multiple" id="'+e.n+'">',e.d.forEach(function(t){selected="",b&&b.indexOf(t[0])>=0&&(selected="selected='selected'"),v+='<option value="'+t[0]+'" '+selected+">"+t[1]+"</option>"}),v+="</select>"),"tags"===e.t){v+='<select name="'+e.n+'" style="width:100%" class="select_tag" multiple="multiple">';var k=_.filter(e.d[0],function(t){return"undefined"!=t});e.tr&&(k=_.flatten(_.map(k,function(t){return t[window.localStorage.getItem("foxx-locale")]}))),_.uniq(k).forEach(function(t){"undefined"!=t&&""!=t&&void 0!=t&&(selected="",b&&b.indexOf(t)>=0&&(selected="selected='selected'"),v+='<option value="'+t+'" '+selected+">"+t+"</option>")}),v+="</select>"}if("map"===e.t&&(""===b&&(b=[0,0]),v+='<div class="uk-text-center" id="'+e.n+'_infos"><span class="uk-label"></span></div>',v+='<div id="map_'+e.n+'" class="map" style="'+e.s+'"></div>',v+='<input id="'+e.n+'_lat" type="hidden" name="'+e.n+'" value="'+b[0]+'" />',v+='<input id="'+e.n+'_lng" type="hidden" name="'+e.n+'" value="'+b[1]+'" />',c.push([e.n,b])),"image"===e.t&&t._id&&(v+='<div id="upload-drop_'+e.n+'" class="js-upload uk-placeholder uk-text-center">',v+='    <span uk-icon="icon: cloud-upload"></span>',v+='    <span class="uk-text-middle">Attach images by dropping them here or</span>',v+="    <div uk-form-custom>",v+='        <input type="file" multiple>',v+='        <span class="uk-link">selecting one</span>',v+="    </div>",v+="</div>",v+='<progress id="progressbar_'+e.n+'" class="uk-progress" value="0" max="100" hidden></progress>',v+='<images i18n="'+e.tr+'" field="'+e.n+'" id="'+t._id+'" />',n.push([t._key,t._id.split("/")[0],e.n,"*.(jpg|jpeg|gif|png)","progressbar_"+e.n,"#upload-drop_"+e.n,e.tr])),"file"===e.t&&t._id&&(v+='<div id="upload-drop_'+e.n+'" class="js-upload uk-placeholder uk-text-center">',v+='    <span uk-icon="icon: cloud-upload"></span>',v+='    <span class="uk-text-middle">Attach binaries by dropping them here or</span>',v+="    <div uk-form-custom>",v+='        <input type="file" multiple>',v+='        <span class="uk-link">selecting one</span>',v+="    </div>",v+="</div>",v+='<progress id="progressbar_'+e.n+'" class="uk-progress" value="0" max="100" hidden></progress>',v+='<files i18n="'+e.tr+'" field="'+e.n+'" id="'+t._id+'" />',n.push([t._key,t._id.split("/")[0],e.n,"*.*","progressbar_"+e.n,"#upload-drop_"+e.n,e.tr])),"boolean"===e.t){var y=t[e.n]===!0?" checked='checked' ":"";v+=' <input name="'+e.n+'" '+y+'  class="uk-checkbox" type="checkbox" value="1"  /> '}v+="</div>",f||(o+=v,v=""),1==e.endtab&&(""!=o&&p.push(v),v="",f=!1,o+='</ul><ul class="uk-switcher">{{'+h+"}}</ul>"),g++}}),o+="</div>",p.length>0){var b="";_.each(p,function(t){""!=t&&(b+="<li>"+t+"</li>")}),o=o.replace("{{"+h+"}}",b)}o+='<hr><div class="uk-grid uk-grid-small uk-text-right"><div class="uk-width-1-1">',void 0!=i&&(o+='<a href="#'+i+'" class="uk-button">Back</a> '),o+='<input type="submit" class="uk-button uk-button-primary" value="Save" /></div></div><hr>',$(a).html(o),$(a).find("select").on("change",function(){d.checkConditions(e,a)}),d.checkConditions(e,a),r.forEach(function(t,e){$(a+" #"+t[0]).val(t[1])}),$(".datepicker-here").datepicker({language:"en",timepicker:!0,timeFormat:"hh:ii",dateFormat:"yyyy-mm-dd"}),m.forEach(function(t,e){if(_.isString(t[1]))try{t[1]=JSON.parse(t[1])}catch(t){}$("#html_editor_"+t[0]).contentEditor({value:t[1].html||""}),$("#"+t[0]).val(JSON.stringify(t[1]))}),l.forEach(function(t,e){d.startEditor(t[0],t[1],t[2])}),u.forEach(function(t,e){$("#"+t).trumbowyg()}),$("button").attr("type","button"),c.forEach(function(t,e){var a=L.map("map_"+t[0],{dragging:!0,tap:!1}).setView(t[1],6);L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"}).addTo(a),a.scrollWheelZoom.disable();var i=L.marker(t[1],{draggable:!0}).addTo(a);$("#"+t[0]+"_infos span").html(t[1].join(", ")),i.on("dragend",function(e){var a=e.target.getLatLng();$("#"+t[0]+"_lat").val(a.lat),$("#"+t[0]+"_lng").val(a.lng),$("#"+t[0]+"_infos span").html([a.lat,a.lng].join(", "))}),setTimeout(function(){a.invalidateSize(!0)},0)});var d=this;n.forEach(function(t){d.prepare_upload(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}),riot.mount("images"),riot.mount("files"),riot.update(),void 0!==s&&s()},checkLogin:function(){this.ajax(url+"auth/whoami","GET","",function(t){null===t.username&&(document.location.href="login.html")})},saveForm:function(t,e,a,i){a=a||"",i=i||{};var s=this,o=$("#"+t).serializeObject();_.each(o,function(t,e){"trumbowyg"==e.split("-")[0]&&delete o[e]}),$(".select_tag, .select_mlist").each(function(t,e){"string"==typeof o[$(e).attr("name")]&&(o[$(e).attr("name")]=[o[$(e).attr("name")]])}),$("div[data-hint]").html("");var n="#"+t+" textarea, #"+t+" input, #"+t+" select";$(n).removeClass("uk-form-danger"),$(n).removeClass("uk-form-success"),$(n).addClass("uk-form-success"),s.ajax(url+e+"/"+a,"POST",JSON.stringify(o),function(s){s.errors.length>0?s.errors.forEach(function(t){$("#"+t.path).removeClass("uk-form-success"),$("#"+t.path).addClass("uk-form-danger"),$("div[data-hint="+t.path+"]").html("<div>"+t.message.replace(/"(.*)"/,"").trim()+"</div>")}):(UIkit.notification({message:"Successfully saved!",status:"success",timeout:1e3,pos:"bottom-right"}),""==a&&_.isEmpty(i)&&(a=s.data._key,"datasets"!=e.split("/")[0]&&(e=2==e.split("/").length?e.split("/")[1]:e),route("/"+e+"/"+a+"/edit")),_.isEmpty(i)||void 0!=i.element_id||riot.mount("#"+i.id,_.last(t.split("_"))+"_crud_index",i)),setTimeout(function(){$(n).removeClass("uk-form-success")},300)})},ajax:function(t,e,a,i,s){"undefined"==typeof s&&(s=function(){}),$.ajax({url:t,data:a||"",type:e,beforeSend:function(t){var e=localStorage.getItem("X-Session-Id");null!==e&&(t.setRequestHeader("foxx-locale",localStorage.getItem("foxx-locale")),t.setRequestHeader("X-Session-Id",localStorage.getItem("X-Session-Id")))},success:function(t,e,a){a.getResponseHeader("X-Session-Id")&&localStorage.setItem("X-Session-Id",a.getResponseHeader("X-Session-Id")),i(t)},statusCode:{401:function(){document.location.href="/static/admin/login.html"},500:s(),503:function(){localStorage.removeItem("X-Session-Id"),localStorage.removeItem("foxx-locale"),document.location.href="/static/admin/login.html"}}})},get:function(t,e,a){this.ajax(t,"GET","",e,a)},"delete":function(t,e,a){this.ajax(t,"DELETE","",e,a)},post:function(t,e,a,i){this.ajax(t,"POST",e,a,i)},patch:function(t,e,a,i){this.ajax(t,"PATCH",e,a,i)},put:function(t,e,a,i){this.ajax(t,"PUT",e,a,i)},array_diff:function(t,e){return t.filter(function(t){return e.indexOf(t)<0})},keys:function(t){var e=[];for(var a in t)e.push(a);return e},prepare_upload:function(t,e,a,i,s,o,n){var d=document.getElementById(s);UIkit.upload(o,{url:"/file/upload/"+t+"/"+e+"/"+a,multiple:!0,allow:i,error:function(){console.log("error",arguments)},beforeSend:function(t){t.headers={"X-Session-Id":localStorage.getItem("X-Session-Id"),"foxx-locale":1==n?localStorage.getItem("foxx-locale"):null}},loadStart:function(t){d.removeAttribute("hidden"),d.max=t.total,d.value=t.loaded},progress:function(t){d.max=t.total,d.value=t.loaded},loadEnd:function(t){d.max=t.total,d.value=t.loaded},completeAll:function(){d.value=100,setTimeout(function(){d.setAttribute("hidden",null),riot.mount("images"),riot.mount("files"),riot.update()},250)}})}};a.exports=i}),require.register("js/config.js",function(t,e,a){var i={".fasty.ovh":"/_db/",".whoistheboss.ovh":"/_db/",".inseytel.com":"/_db/"};a.exports=i}),require.register("js/editor.js",function(t,e,a){!function(t){t.fn.contentEditor=function(e){var a,i,s,o,n,d=t(this).attr("data-name")||"solicms",l=this,r=t.extend({widgets:[{id:"h1",icon:"fas fa-heading",title:"h1"},{id:"h2",icon:"fas fa-heading",title:"h2"},{id:"h3",icon:"fas fa-heading",title:"h3"},{id:"h4",icon:"fas fa-heading",title:"h4"},{id:"h5",icon:"fas fa-heading",title:"h5"},{id:"h6",icon:"fas fa-heading",title:"h6"},{id:"col2",icon:"fas fa-columns",title:"2"},{id:"col3",icon:"fas fa-columns",title:"3"},{id:"col4",icon:"fas fa-columns",title:"4"},{id:"col363",icon:"fas fa-columns",title:"3-6-3"},{id:"col48",icon:"fas fa-columns",title:"4-8"},{id:"col84",icon:"fas fa-columns",title:"8-4"},{id:"text",icon:"fas fa-align-left",title:"text"},{id:"img",icon:"fas fa-image",title:"img"},{id:"slide",icon:"fas fa-images",title:"slide"},{id:"code",icon:"fas fa-code",title:"code"},{id:"video",icon:"fas fa-video",title:"video"},{id:"html5",icon:"fab fa-html5",title:"html5"}]},e),c=0,u=function(t){return window.localStorage.removeItem(t)};u("editor-history");var m=function(t){for(var e="Chocolate lollipop pastry tiramisu. Chocolate cake sweet roll dragée. Cookie halvah tootsie roll cupcake candy canes pie oat cake danish chocolate cake. Cheesecake biscuit powder sweet powder. Chocolate bar lollipop jelly-o chocolate cake. Sweet roll sweet roll cupcake topping chocolate cake. Fruitcake chocolate cake jelly-o. Marzipan candy canes jujubes. Cotton candy candy canes icing sesame snaps chocolate cake toffee liquorice jelly-o. Pastry pastry bear claw toffee. Liquorice biscuit dessert chocolate bar gummies. Carrot cake danish cookie croissant toffee gingerbread sweet roll. Icing danish muffin cheesecake jelly-o sugar plum pastry cotton candy. Chocolate bar pie apple pie chocolate bar cupcake lollipop.".split("."),a=[],i=0;i<t;i++)a.push(e[parseInt(1e3*Math.random()%e.length)]);return a.join(". ")+"."},f=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p=function(e,a,i){var s,o,n;switch(c%=3,a){case"h1":s='<div class="sg-row cms_row" data-type="h1"><div class="col-12 cms_col">',o='<h1 data-type="h1" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h1>',n="</div></div>";break;case"h2":s='<div class="sg-row cms_row" data-type="h2"><div class="col-12 cms_col">',o='<h2 data-type="h2" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h2>',n="</div></div>";break;case"h3":s='<div class="sg-row cms_row" data-type="h3"><div class="col-12 cms_col">',o='<h3 data-type="h3" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h3>',n="</div></div>";break;case"h4":s='<div class="sg-row cms_row" data-type="h4"><div class="col-12 cms_col">',o='<h4 data-type="h4" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h4>',n="</div></div>";break;case"h5":s='<div class="sg-row cms_row" data-type="h5"><div class="col-12 cms_col">',o='<h5 data-type="h5" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h5>',n="</div></div>";break;case"h6":s='<div class="sg-row cms_row" data-type="h6"><div class="col-12 cms_col">',o='<h6 data-type="h6" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h6>',n="</div></div>";break;case"img":s='<div class="sg-row cms_row" data-type="img"><div class="col-12 cms_col">',o='<div data-type="img" class="drag drop" data-editable="true"><img src="https://fasty.ovh/asset/o/06650e1c-2579-463b-94fd-fc09655d3cd1?_from=Y21z" alt=""></div>',n="</div></div>";break;case"text":s='<div class="sg-row cms_row" data-type="text"><div class="col-12 cms_col">',o='<div data-type="text" class="drag drop" data-editable="true"><p style="text-align: justify;">'+m(5)+"</p></div>",n="</div></div>";break;case"code":var d=[];d.push('<code class="language-html">'+f("<h1>Some html code</h1>")+"</code>"),d.push('<code class="language-javascript">console.log("JS ... really ? ")</code>'),d.push('<code class="language-ruby">puts "I Love Ruby"</code>'),s='<div class="sg-row cms_row" data-type="code"><div class="col-12 cms_col">',o='<div data-type="code" class="drag drop" data-editable="true"><pre>'+d[c]+"</pre></div>",n="</div></div>";break;case"video":var l=["AWKEWqx8OyA","TmDKbUrSYxQ","X8zLJlU_-60"],r='<div style="position:relative;padding-top:56.25%;"><iframe src="https://www.youtube.com/embed/'+l[c]+'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div>';s='<div class="sg-row cms_row" data-type="embed"><div class="col-12 cms_col">',o='<div data-type="embed" class="drag drop" data-editable="true" data-html="'+r.replace(/"/g,"&quot;")+'">'+r+"</div>",n="</div></div>";break;case"html5":s='<div class="sg-row cms_row" data-type="embed"><div class="col-12 cms_col">';var r="<p>HTML5 Code here</p>";o='<div data-type="embed" class="drag drop" data-editable="true" data-html="'+r.replace(/"/g,"&quot;")+'">'+r+"</div>",n="</div></div>";break;case"col2":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col2"><div class="col-6 cms_col"></div><div class="col-6 cms_col"></div></div>',n="";break;case"col3":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col3"><div class="col-4 cms_col"></div><div class="col-4 cms_col"></div><div class="col-4 cms_col"></div></div>',n="";break;case"col4":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col4"><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div></div>',n="";break;case"col282":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col282"><div class="col-2 cms_col"></div><div class="col-8 cms_col"></div><div class="col-2 cms_col"></div><div class="col-3 cms_col"></div></div>',n="";break;case"col363":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col363"><div class="col-3 cms_col"></div><div class="col-6 cms_col"></div><div class="col-3 cms_col"></div></div></div>',n="";break;case"col48":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col48"><div class="col-4 cms_col"></div><div class="col-8 cms_col"></div></div></div>',n="";break;case"col84":s="",o='<div class="sg-row cms_row sub_row drag" data-type="col84"><div class="col-8 cms_col"></div><div class="col-4 cms_col"></div></div></div>',n="";break;default:s="",o=h(atob(e.data("partial")),JSON.parse(atob(e.data("model"))),JSON.parse(atob(e.data("dataset")))),n=""}return c++,t(i?s+o+n:o)},h=function(t,e,a){var i=t+"";return e.forEach(function(s){var o=Object.keys(s)[0],n=Object.values(s)[0];if(Object.keys(n).indexOf("_fields")<0){var d=a[o]||n["default"]||"";t=t.replace("<!-- @"+o+" -->",d)}else{var l=("<!-- #"+o+" -->").length,r=t.indexOf("<!-- #"+o+" -->"),c=t.indexOf("<!-- /"+o+" -->"),u=t.substring(r+l,c),m="",f=a[o]||n["default"];f.forEach(function(t){n._fields.forEach(function(e){m+=u.replace("<!-- @"+e.name+" -->",t[e.name])})}),t="<div class='drag' data-editable='true' data-type='widget' data-model='"+btoa(i)+"' data-dataset='"+btoa(JSON.stringify(e))+"' data-partial='"+btoa(JSON.stringify(a))+"'>"+t.substring(0,r)+m+t.substring(c+l,t.length)+"</div>"}}),t},g=function(){t.get(url+"/api/_widgets",function(a){if(a.data){n=a.data;var i='<aside class="edit-mode sg-widgets">',s="";n.forEach(function(t){s+="<div class='drag' data-dataset=\""+btoa("{}")+'" data-partial="'+btoa(t.partial)+"\" data-menuItem='widget' data-model=\""+btoa(t.model)+'" dragdraggable="true"><img style="max-width: 100%;" src="'+(t.picture||"https://fasty.ovh/asset/o/06650e1c-2579-463b-94fd-fc09655d3cd1?_from=Y21z")+'" /></div>',s+="<div>"+t.name+"</div>"}),""!=s&&(i+=s+"</aside>",t(l).append(i)),C(e.value)}})},v=function(){window.drag=function(e){var i=t(e.target).hasClass("drag")?t(e.target):t(e.target).closest(".drag");i.addClass("dragging"),e.stopPropagation(),a=i,e.dataTransfer.setData("text",""),setTimeout(function(){b()},0)},window.drop=function(e){e.stopPropagation(),e.preventDefault();var i=t(e.target).hasClass("drop")?t(e.target):t(e.target).closest(".drop");if(e.dataTransfer.items){var s=!1,o=e.dataTransfer.items.length;o>1&&(o=1);for(var n=0;n<e.dataTransfer.items.length;n++)if("file"===e.dataTransfer.items[n].kind){s=!0;var d=e.dataTransfer.items[n].getAsFile();if(d.type.indexOf("image")>=0){var l=new FileReader;l.readAsDataURL(d),l.onloadend=function(){base64data=l.result;var e=new FormData;e.append("files",d),e.append("key",localStorage.getItem("resize_api_key")),t.ajax({headers:{"X-Session-Id":localStorage.getItem("X-Session-Id")},xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var a=e.loaded/e.total;t(i).html(parseInt(100*a)+"%")}},!1),e},type:"POST",url:"/file/upload",data:e,processData:!1,contentType:!1,success:function(e){e=JSON.parse(e),setTimeout(function(){var a="<picture>";a+='\n  <source media="(max-width: 480px)" srcset="/asset/r/'+e.filename+"/480.webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='\n  <source media="(max-width: 480px)" srcset="/asset/r/'+e.filename+"/480?_from="+btoa(subdomain)+'">',a+='\n  <source media="(max-width: 799px)" srcset="/asset/r/'+e.filename+"/799.webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='\n  <source media="(max-width: 799px)" srcset="/asset/r/'+e.filename+"/799?_from="+btoa(subdomain)+'">',a+='\n  <source media="(min-width: 800px)" srcset="/asset/o/'+e.filename+".webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='\n  <source media="(min-width: 800px)" srcset="/asset/o/'+e.filename+"?_from="+btoa(subdomain)+'">',a+='\n  <img src="/asset/o/'+e.filename+'">',a+="\n</picture>",t(i).html(a)},100),x()}})}}}s||(t(".active").removeClass("active"),a.hasClass("cms_col")?i.hasClass("cms_col")?k(a,i):k(a,0==i.children().length?i:i.children().first()):i.hasClass("cms_col")?k(a.children().first(),i):k(a,i),i.removeClass("drop_empty"),i.hasClass("drag")||(y(i),w(i)),t(".drop_empty").remove(),x(),_())}},window.drag_end=function(e){e.stopPropagation(),t(".row_editor").css("margin-left","-99999px"),t(".dragging").removeClass("dragging"),t(".active").removeClass("active"),t(".drop_empty").remove(),x()},window.allow_drop=function(e){e.stopPropagation(),e.preventDefault();var a=t(e.target).hasClass("drop")?t(e.target):t(e.target).closest(".drag");t(".active").removeClass("active"),a.addClass("active")}},_=function(){t(l).find(".cms_row").removeClass("empty_row"),t(l).find(".cms_row").each(function(e,a){""===t(a).text().trim()&&t(a).addClass("empty_row")})},b=function(){x();var e='<div class="sg-row cms_row" data-type="full"><div class="col-12 cms_col"><div class="drop drop_empty row_empty"></div></div></div>',a='<div class="drop drop_empty col_empty"><div></div></div>';t(l).find(".edit-mode .cms_editor .sub_row .cms_col .drop").each(function(e,i){(t(i).parent().hasClass("cms_col")||t(i).parent().hasClass("cms_row"))&&t(i).after(a)}),t(l).find(".edit-mode .page-content > .cms_row").each(function(a,i){t(i).before(e)}),t(l).find(".edit-mode .cms_col").each(function(e,i){t(i).hasClass("col-12")||t(i).prepend(a)}),t(l).find(".edit-mode .cms_editor .page-content").append(e),t(l).find(".edit-mode .drop_empty").attr("ondragover","allow_drop(event)"),t(l).find(".edit-mode .drop_empty").attr("ondrop","drop(event)")},k=function(e,a){e=e[0],a=a[0];const i=a.nextElementSibling,s=a.parentNode;if(t(e).data("menuitem")){var o=p(t(e),t(e).data("menuitem"),!1);if(t(a).hasClass("row_empty")){var n=t(o).hasClass("sub_row")?t(s).parent():t(s);n.html(o[0].outerHTML)}else t(a).hasClass("col_empty")?(t(a).html(o[0].outerHTML),t(a).removeClass("row_empty"),t(a).removeClass("col_empty"),t(a).addClass("drag")):t(s).hasClass("sg-container")||t(s).html(o[0].outerHTML);y(t(".drag")),w(t(".drop"))}else{try{const d=e;e.replaceWith(a),s.insertBefore(e,i)}catch(r){s.appendChild(d)}x()}t(l).find("[data-type=full] .col-12").each(function(e,a){if(t(a).find(".sg-row").length>0){var i=t(a).html();t(a).parent()[0].outerHTML=i}})},y=function(t){t.attr("draggable",!0),t.attr("ondragstart","drag(event)"),t.attr("ondragend","drag_end(event)")},w=function(t){t.addClass("drop"),t.attr("ondragover","allow_drop(event)"),t.attr("ondrop","drop(event)")},x=function(){t(l).find(".edit-mode .drop").each(function(e,a){var i=t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;0!=t(a).find(".cms_col").length||i||""!=t(a).text().trim()||"img"==t(a).data("type")||"embed"==t(a).data("type")||t(a).remove(),t(a).hasClass("drop")&&!t(a).hasClass("drag")&&t(a).remove()}),t(l).find(".edit-mode .drag").each(function(e,a){var i=t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;i&&t(a).parent().find(".drag").length>1&&(""==t(a).html().trim()||"<div></div>"==t(a).html().trim())&&!t(a).is("img")&&t(a).remove()}),t(l).find(".edit-mode .cms_row > *").each(function(e,a){t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;(!t(a).hasClass("cms_col")&&""==t(a).html().trim()||"<div></div>"==t(a).html().trim())&&t(a).remove()}),t(l).find(".edit-mode .cms_row").each(function(e,a){""!=t(a).html().trim()&&"<div></div>"!=t(a).html().trim()&&'<div class="col-12 cms_col"></div>'!=t(a).html().trim()||t(a).remove()})},S=function(e){var a=[];return t(e).find("> .cms_row").each(function(e,i){"full"==t(i).data("type")&&(t(i).find("div:first").hasClass("cms_col")?t(i).data("type",t(i).find("[data-type]").data("type")):i=t(i).children()[0]);var s={data:[],type:t(i).data("type")};t(i).find("> .cms_col").each(function(e,a){var i=[];t(a).find("[data-type]").each(function(e,a){if(void 0==t(a).data("exported")){t(a).data("exported",!0);var s={};s.type=t(a).data("type"),s.attr=t(a).data("attr"),t(a).data("type").indexOf("col")>=0?s.content=S(t(a).parent()):s.content=t(a).data("html")||t(a).html(),i.push(s)}}),s.data.push(i)}),a.push(s)}),t(e).find("[data-exported]").removeAttr("data-exported"),a},C=function(e){t(l).find(".page-content").html(e||""),x(),_(),y(t(l).find(".drag")),y(t(l).find(".drop")),j(),$(),t(l).find("[data-html]").each(function(e,a){t(a).html(t(a).data("html"))})},j=function(){t(l).find(".edit-mode .cms_editor").on("mouseenter",".cms_row",function(){t(l).find(".edit-mode .row_editor").css("margin-left","-99999px");var e=0-t(l).find(".cms_editor").offset().top+t(this).offset().top+t(this).height()-t(l).find(".row_editor").height(),a=t(this).offset().left+16-100;t(l).find(".edit-mode .row_editor").css("margin-left",a+"px"),t(l).find(".edit-mode .row_editor").css("margin-top",e+"px"),i=t(this)}),t(l).find(".edit-mode .cms_editor").on("mouseenter",".cms_col > *",function(){t(this).offset().top,t(this).offset().left-t(l).find("aside").width();i=t(this)}),t(l).find(".edit-mode .cms_row_delete").on("click",function(){return i.closest(".edit-mode .sg-row").remove(),!1}),t(l).find(".edit-mode .page-content").on("click","[data-type]",function(){if(s=t(this),raw_object=t(this.outerHTML),"widget"!=raw_object.data("type")){if(raw_object.data("attr")?(t(l).find("input[data-name=col-class]").val(raw_object.data("attr")["col-class"]),t(l).find("input[data-name=row-class]").val(raw_object.data("attr")["row-class"]),t(l).find("input[data-name=container-class]").val(raw_object.data("attr")["container-class"])):(t(l).find("input[data-name=col-class]").val(""),t(l).find("input[data-name=row-class]").val(""),t(l).find("input[data-name=container-class]").val("")),t(l).find(".editor-code").hide(),t(l).find(".editor-simplecode").hide(),t(l).find(".editor-img-code").hide(),raw_object.data("editable")){t(l).find(".trumbowyg").hide(),t(l).find("#ace-editor-"+d).hide();var e=t(this).html().trim();if(t(l).find(".edit-mode .cms_editor").addClass("editmode"),"text"==raw_object.data("type")&&(t("#trumbowyg-"+d).trumbowyg("html",e),t(l).find(".trumbowyg").show()),"code"==raw_object.data("type")&&(t(l).find(".editor-code").show(),t(l).find("#ace-editor-"+d).show(),t(l).find("input[data-name=lang]").val(raw_object.find("code:first")[0].className.replace("language-","")),o.session.setMode("ace/mode/"+a),o.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0}),o.getSession().setValue(t(this).text())),["embed","h1","h2","h3","h4","h5","h6"].indexOf(raw_object.data("type"))>=0){t(l).find(".editor-simplecode").show(),t("#ace-editor-"+d).show();var a="html";o.session.setMode("ace/mode/"+a),o.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0});var e=t(this).html();"embed"==raw_object.data("type")&&(e=t(this).attr("data-html").replace(/&quot;/g,'"')),o.getSession().setValue(e)}if(["img"].indexOf(s.data("type"))>=0){var i=t(this).find(".img-div").length>0?t(this).find(".img-div"):t(this).find("img").parent();t(l).find(".editor-simplecode").show(),t(l).find(".editor-img-code").show(),t("#ace-editor-"+d).show(),t(l).find("input[data-name=img-width").val(i.attr("data-img-width")),t(l).find("select[data-name=img-alignment").val(i[0].style["text-align"]);var a="html";o.session.setMode("ace/mode/"+a),o.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0}),e=t(this).find(".img-div").length>0?t(this).find(".img-div").html():t(this).html(),o.getSession().setValue(e)}}}else t(l).find(".edit-mode .widget_editor").addClass("editmode");return!1}),t(l).find(".edit-mode .sg-editcontent").on("click",".fa-times-circle",function(){return t(".edit-mode .cms_editor").removeClass("editmode"),t(".edit-mode .widget_editor").removeClass("editmode"),L(),!1}),t(l).find(".edit-mode .addwidget").on("click",function(e){e.preventDefault();var a=p(t(this),t(this).data("id"),!0);return t(l).find(".edit-mode .page-content").append(a),t(l).find(".edit-mode .drag").attr("draggable",!0),t(l).find(".edit-mode .drag").attr("ondragstart","drag(event)"),t(l).find(".edit-mode .drag").attr("ondragover","allow_drop(event)"),t(l).find(".edit-mode .drag").attr("ondrop","drop(event)"),t(l).find(".edit-mode .drag").attr("ondragend","drag_end(event)"),
_(),!1}),t(l).find(".toggle-layout").on("click",function(e){e.preventDefault(),v(),t(l).find(".view-mode").toggleClass("isactive"),t(l).find(".edit-mode").toggleClass("isactive"),t(l).toggleClass("fullscreen"),t("[data-exported]").removeAttr("data-exported");var a={html:t(l).find(".edit-mode .page-content").html(),json:S(t(l).find(".edit-mode .page-content"))};return t('input[name="'+d+'"]').val(JSON.stringify(a)),t(l).find(".page-content").html(a.html||""),$(),t(l).find("[data-html]").each(function(e,a){t(a).html(t(a).attr("data-html"))}),!1})},$=function(){t(l).find(".view-mode .drag, .view-mode .drop").removeAttr("ondragend").removeAttr("ondragstart").removeAttr("ondragover").removeAttr("ondrop")},I='<a href="" class="toggle-layout view-mode isactive">Edit content</a>';I+='<section class="view-mode isactive">                        <div class="page-content"></div></section>',t(l).append(I);var O='<aside class="edit-mode">                   <div class="sg-container toolbox"><h1>Page tools</h1>                    <div class="sg-row"></div>                   <div class="sg-row"><a href="" class="toggle-layout">Exit</a></div></div>                  </aside>';t(l).append(O),t(l).addClass("editor-cms"),r.widgets.forEach(function(e){t(l).find(".toolbox .sg-row:first").append('      <div class="col-4 drag" dragdraggable="true" data-menuitem="'+e.id+'">        <a href="#" class="addwidget" data-id="'+e.id+'">          <i class="'+e.icon+'"></i>          <div class="small">'+e.title+"</div></a>      </div>")});var E='<section class="edit-mode">      <div class="widget_editor"><div class="sg-editcontent"><i class="far fa-times-circle" style="float: right;padding: 10px"></i></div></div>      <div class="cms_editor">        <div class="row_editor">          <div class="cms_toolbar">            <ul>              <li><a href="#" class="cms_row_delete"><i class="fas fa-trash-alt"></i></a></li>            </ul>          </div>        </div>        <div class="sg-container page-content"></div>        <div class="sg-editcontent">          <i class="far fa-times-circle" style="float: right;padding: 10px"></i>          <div class="content">            <div id="trumbowyg-'+d+'"></div>            <div><label>Container Class</label><input type="text" data-name="container-class" class="uk-input"></div>            <div><label>Row Class</label><input type="text" data-name="row-class" class="uk-input"></div>            <div><label>Col Class</label><input type="text" data-name="col-class" class="uk-input"></div>            <div class="editor-code"><label>Language</label><input type="text" data-name="lang" class="uk-input"></div>            <div class="uk-grid"><div class="uk-width-1-2 editor-img-code"><label>Image Width</label><input type="text" data-name="img-width" class="uk-input"></div>            <div class="uk-width-1-2 editor-img-code"><label>Image Alignment</label>            <select class="uk-select" data-name="img-alignment">            <option>left</option><option>center</option><option>right</option></select></div></div>            <div class="editor-code editor-simplecode"><label>Code</label><div id="ace-editor-'+d+'" class="ace-editor"></div></div>          </div>        </div>      </div>    </section>';t(l).append(E),g(),t("#trumbowyg-"+d).trumbowyg({btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["foreColor","backColor"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["table"],["horizontalRule"],["removeformat"],["fullscreen"]],resetCss:!0,svgPath:"img/icons.svg",removeformatPasted:!0}).on("tbwchange",function(){s.html(t("#trumbowyg-"+d).trumbowyg("html"))}),o=ace.edit("ace-editor-"+d),o.getSession().setUseWrapMode(!0),o.setTheme("ace/theme/twilight"),o.session.setMode("ace/mode/html");var L=function(){if(s){var e={"col-class":t("input[data-name=col-class]").val(),"row-class":t("input[data-name=row-class]").val(),"container-class":t("input[data-name=container-class]").val()},a=o.getSession().getValue();if("code"==s.data("type")){var i="language-"+t(l).find("input[data-name=lang]").val();s.html('<pre><code class="'+i+'">'+f(a)+"</code></pre>")}if(["h1","h2","h3","h4","h5","h6"].indexOf(s.data("type"))>=0&&s.html(a),["embed"].indexOf(s.data("type"))>=0&&(s.html(a),s.attr("data-html",a)),["text"].indexOf(s.data("type"))>=0&&s.html(t("#trumbowyg-"+d).trumbowyg("html")),["img"].indexOf(s.data("type"))>=0){var n=t(l).find("input[data-name=img-width").val()?t(l).find("input[data-name=img-width").val():"100%",r=t(l).find("select[data-name=img-alignment").val()?t(l).find("select[data-name=img-alignment").val():"left",c=t("<div>").append(t.parseHTML(a));c.each(function(){for(var e=t(this).find("img"),a=0;a<e.length;a++)e[a].style.width=n}),s.html('<div class="img-div" style="text-align: '+r+'" data-img-width="'+n+'">'+c[0].innerHTML+"</div>")}s.attr("data-attr",JSON.stringify(e))}};return this}}(jQuery)}),require.register("js/js.js",function(t,e,a){document.removeEventListener("keydown",function(){}),document.addEventListener("keydown",function(t){83==t.keyCode&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&(t.preventDefault(),$("input[type=submit]:visible").click())},!1),$(function(){riot.mount("rightnav"),route("/",function(t){riot.mount("div#app","loading")}),route("/welcome",function(t){riot.mount("div#app","welcome")}),route("/login",function(t){riot.mount("div#app","login")}),route("/signup",function(t){riot.mount("div#app","signup")}),route("/confirm/*",function(t){common.post(url+"auth/confirm",JSON.stringify({uuid:t}),function(){document.location.href="index.html"})}),route("/logout",function(t){common.post(url+"auth/logout","",function(t){localStorage.removeItem("X-Session-Id"),document.location.href="login.html"})}),route("/settings",function(){riot.mount("div#app","settings")}),route("/datasets/*",function(t){riot.mount("div#app","datasets",{datatype:t})}),route("/datasets/*/new",function(t){riot.mount("div#app","dataset_new",{datatype:t})}),route("/datasets/*/*",function(t,e){riot.mount("div#app","datasets",{datatype:t,folder_key:e})}),route("/datasets/*/new/*",function(t,e){riot.mount("div#app","dataset_new",{datatype:t,folder_key:e})}),route("/datasets/*/*/edit",function(t,e){riot.mount("div#app","dataset_edit",{datatype:t,dataset_id:e})}),route(function(t,e,a){}),route(function(t,e){}),route.start(!0),document.location.host.indexOf("prod.")>=0&&$("body").css("background","linear-gradient(150deg,#370d13 0,#283a63 100%)"),document.location.host.indexOf("staging.")>=0&&$("body").css("background","linear-gradient(150deg,#33521c 0,#283a63 100%)"),document.location.host.indexOf("qa.")>=0&&$("body").css("background","linear-gradient(150deg, rgb(61, 64, 18) 0px, rgb(37, 43, 2) 100%)")})}),require.register("widgets/datasets.html.tag",function(t,e,a){riot.tag2("dataset_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#datasets/{opts.slug}/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#datasets/{opts.slug}/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(a){common.get(url+"/datasets/folders/"+t.slug+"/"+a,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(i){var s=prompt("Folder's name");common.post(url+"/datasets/folders/"+t.slug,JSON.stringify({name:s,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(a){var i=prompt("Update Folder's name");common.patch(url+"/datasets/folders/"+t.slug,JSON.stringify({name:i,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(a){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var a=_.last(_.initial(e.path));common["delete"](url+"/datasets/folders/"+t.slug+"/"+e.folder._key,function(e){common.get(url+"/datasets/folders/"+t.slug+"/"+a._key,function(e){route("/datasets/"+t.slug+"/"+a._key)})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("dataset_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th width="20" if="{sortable}"></th> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody id="sublist"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{calc_value(row, col, locale)} " style="height:50px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){this.sortable=!1,this.data=[];var e=this;this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"datasets/"+t.parent_name+"/"+t.parent_id+"/"+t.model+"/page/"+a+"/"+per_page,function(t){e.data=t.data[0].data;var a=t.model;e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),a.columns&&(e.cols=a.columns),e.sortable=!!a.sortable,e.count=t.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"dataset_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/datasets/"+t.parent_name+"/"+t.model+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.on("updated",function(){if(e.sortable){var a=document.getElementById("sublist");if(a){new Sortable(a,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(e){common.put(url+"datasets/"+t.parent_name+"/"+t.id+"/orders/"+e.oldIndex+"/"+e.newIndex,{},function(){})}})}}})}),riot.tag2("dataset_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_{opts.singular}"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_"+t.singular,"datasets/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"")}.bind(this);var e=this;common.get(url+"/datasets/"+t.parent_name+"/sub/"+t.id+"/"+t.element_id,function(a){e.subdata=a.data,common.buildForm(e.subdata,t.fields,"#"+t.id+"_crud_"+t.singular)}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_dataset"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_dataset")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_dataset","datasets/"+t.parent_name+"/"+t.parent_id+"/"+t.id,"",t)}.bind(this)}),riot.tag2("all_datatypes",'<div class="rightnav uk-card uk-card-default uk-card-body"> <ul class="uk-nav-default uk-nav-parent-icon" uk-nav> <li class="uk-nav-header">Datasets</li> <li each="{datatypes}"><a href="#datasets/{slug}">{name}</a></li> </ul> </div>',"","",function(t){var e=this;this.datatypes=[],common.get(url+"/datasets/datatypes",function(t){e.datatypes=t,e.update()})}),riot.tag2("dataset_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">datasets</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing {object.singular}</h3> <virtual if="{folders.length > 0}"> <label class="uk-label">Path</label> <form onsubmit="{changePath}"> <div class="uk-grid uk-grid-small"> <div class="uk-width-3-4"> <select class="uk-select" ref="folder"> <option riot-value="{folders[0].root._key}" selected="{folders[0].root._key == dataset.folder_key}">Root</option> <option each="{f in folders}" riot-value="{f.folder._key}" selected="{f.folder._key == dataset.folder_key}">{pathName(f.path)}</option> </select> </div> <div class="uk-width-1-4"> <a onclick="{changePath}" class="uk-button uk-button-primary">Change</a> </div> </div> </form> </virtual> <form onsubmit="{save_form}" class="uk-form" id="form_dataset"> </form> <a if="{publishable}" class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.sub_models=[],e.publishable=!1,e.folders=[],this.changePath=function(a){a.preventDefault(),common.put(url+"/datasets/"+t.datatype+"/"+t.dataset_id+"/change_folder",JSON.stringify({folder_key:e.refs.folder.value}),function(t){UIkit.notification({message:"Successfully updated!",status:"success",timeout:1e3,pos:"bottom-right"})})}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm("form_dataset","datasets/"+t.datatype,t.dataset_id)}.bind(this),this.duplicate=function(a){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/datasets/"+t.datatype+"/"+e.dataset._key+"/duplicate",function(e){route("/datasets/"+t.datatype+"/"+e._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.pathName=function(t){return _.map(t,function(t){return t.name}).join(" > ")}.bind(this),this.publish=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/datasets/"+e.dataset._key+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/datasets/"+t.datatype+"/"+t.dataset_id,function(a){e.publishable=a.model.publishable,e.object=a.model,e.dataset=a.data,e.folders=a.folders,e.fields=a.fields,e.sub_models=a.model.sub_models;var i=a.model.act_as_tree;_.isArray(e.fields)||(fields=fields.model),common.get(url+"/auth/whoami",function(s){localStorage.setItem("resize_api_key",s.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,s.role),e.loaded=!0,e.update();var o="";e.can_access&&(o="datasets/"+t.datatype),i&&e.dataset.folder_key&&(o+="/"+e.dataset.folder_key),common.buildForm(e.dataset,e.fields,"#form_dataset",o,function(){$(".crud").each(function(a,i){var s=$(i).attr("id");riot.mount("#"+s,"dataset_crud_index",{model:s,fields:e.sub_models[s].fields,key:e.sub_models[s].key,singular:e.sub_models[s].singular,columns:e.sub_models[s].columns,parent_id:t.dataset_id,parent_name:t.datatype})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_new",'<virtual if="{can_access}"> <h3>Creating {object.singular}</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_dataset"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_new_dataset","datasets/"+t.datatype)}.bind(this),common.get(url+"/datasets/"+t.datatype+"/fields",function(a){e.object=a.object,common.get(url+"/auth/whoami",function(i){if(localStorage.setItem("resize_api_key",i.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var s=a.fields,o={},n="datasets/"+t.datatype;e.opts.folder_key&&(s.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),o.folder_key=t.folder_key,n+="/"+t.folder_key),common.buildForm(o,s,"#form_new_dataset",n)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_tags",'<span each="{row in data}"> {row.tag} <span class="uk-badge uk-margin-right">{row.size}</span> </span>',"","",function(t){var e=this;common.get(url+"/datasets/"+t.datatype+"/stats/"+this.opts.tag,function(t){e.data=t,e.update()})}),riot.tag2("datasets",'<dataset_folders show="{loaded}" if="{act_as_tree}" folder_key="{folder_key}" slug="{opts.datatype}"></dataset_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#datasets/{opts.datatype}/new/{folder_key}" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New {model.singular}</a> <a if="{!act_as_tree}" href="#datasets/{opts.datatype}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New {model.singular}</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing {opts.datatype}</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <dataset_tags if="{show_stats}" datatype="{opts.datatype}" tag="{show_stats_tag}"></dataset_tags> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}" class="{col.class}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}" id="row_{row._key}" no-reorder key="{row._key}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.trads == true}"> <div each="{lang in langs}"><a onclick="{traduct}" data-lang="{lang}" data-id="{row._key}" data-value="{calc_value(row, col, lang)}" class="uk-button uk-button-small">{lang} :</a> <span id="trad_{lang}_{row._key}">{calc_value(row, col, lang)}</span></div> </virtual> <virtual if="{col.trads != true}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a riot-style="color: {col.colors ? col.colors[row[col.name][locale]] : \'white\'}" onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a riot-style="color: {col.colors ? col.colors[row[col.name]] : \'white\'}" onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{calc_value(row, col, locale)} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </virtual> </td> <td class="uk-text-center" width="160"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a if="{is_api}" onclick="{install}" class="uk-button uk-button-success uk-button-small"><i class="fas fa-upload"></i></a> <a if="{is_script}" onclick="{install_script}" class="uk-button uk-button-success uk-button-small"><i class="fas fa-upload"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <div id="moreitems" style="height: 50px;">{loaded ? ⁗⁗ : ⁗Loading ...⁗}</div> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.show_stats=!1,this.page=1,this.perpage=per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder_key=this.opts.folder_key||"",this.folder={},this.reach_end=!1,this.act_as_tree=!0,this.settings={},common.get(url+"/settings",function(t){e.settings=t.data}),this.loadPage=function(a){e.loaded=!1,e.update();var i="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/datasets/"+t.datatype+"/page/"+a+"/"+this.perpage+i,function(t){e.reach_end=0==t.data[0].data.length,_.each(t.data[0].data,function(t){e.data.push(t)});var a=t.model;e.model=t.model,e.act_as_tree=a.act_as_tree,e.is_api=!!a.is_api,e.is_script=!!a.is_script,a.stats_for_tag&&(e.show_stats=!0,e.show_stats_tag=a.stats_for_tag,e.update()),e["export"]=!!a["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),a.columns&&(e.cols=a.columns),e.count=t.data[0].count,e.sortable=!!a.sortable,e.loaded=!0,e.langs=t.langs,0==e.can_access?common.get(url+"/auth/whoami",function(t){localStorage.setItem("resize_api_key",t.resize_api_key),console.log(a),e.can_access=void 0===a.roles||_.includes(a.roles.read,t.role),e.update()}):e.update()})},this.setFolder=function(t){e.folder=t||{},e.folder_key=e.folder._key,e.loadPage(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.traduct=function(e){e.preventDefault();var a=e.item.lang,i=$(e.srcElement).data("id"),s=prompt(a,$(e.srcElement).data("value"));return s&&common.patch(url+"/datasets/"+t.datatype+"/"+i+"/value/"+a+"/field",JSON.stringify({value:s}),function(t){$("#trad_"+a+"_"+i).text(s),$(e.srcElement).data("value",s)}),!1}.bind(this),this.filter=function(a){a.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/datasets/"+t.datatype+"/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/datasets/"+this.opts.datatype+"/"+t.item.row._key+"/edit")}.bind(this),this.new_dataset=function(t){route("/datasets/"+this.opts.datatype+"/new")}.bind(this),this.destroy_object=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/datasets/"+t.datatype+"/"+e.item.row._key,function(){$("#row_"+e.item.row._key).remove()})},function(){})}.bind(this),this.toggleField=function(e){e.preventDefault(),common.patch(url+"/datasets/"+t.datatype+"/"+e.target.dataset.key+"/"+e.item.col.name+"/toggle","{}",function(t){t.success&&(e.target.innerText=t.data)})}.bind(this),this.export_data=function(e){common.get(url+"/datasets/"+t.datatype+"/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","datasets.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.install=function(t){t.preventDefault();var a="/service/"+t.item.row.name;return $.post(a,{token:e.settings.token},function(t){"service installed"==t&&UIkit.notification({message:"Endpoint Deployed Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})}),!1}.bind(this),this.install_script=function(t){t.preventDefault();var a="/script/"+t.item.row.name;return $.post(a,{token:e.settings.token},function(t){"script installed"==t&&UIkit.notification({message:"Script Launched Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})}),!1}.bind(this),this.isElementInViewport=function(t){if(t){var e=t.getBoundingClientRect();return e.bottom>0&&e.right>0&&e.left<(window.innerWidth||document.documentElement.clientWidth)&&e.top<(window.innerHeight||document.documentElement.clientHeight)+300}return!1},this.on("mount",function(){$(window).on("DOMContentLoaded load resize scroll",function(t){!e.reach_end&&e.loaded&&e.isElementInViewport(document.getElementById("moreitems"))&&(e.page+=1,e.loadPage(e.page))})}),this.on("updated",function(){if(e.sortable){var a=document.getElementById("list");if(a){new Sortable(a,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(a){var i="?folder_key="+e.folder._key;e.act_as_tree||(i=""),common.put(url+"datasets/"+t.datatype+"/orders/"+a.oldIndex+"/"+a.newIndex+i,{},function(){})}})}}})})}),require.register("widgets/loading.html.tag",function(t,e,a){riot.tag2("loading",'<div class="uk-text-center"> Loading app ... <br><div uk-spinner></div> </div>',"","",function(t){common.get(url+"auth/whoami",function(t){null===t.username?document.location.href="login.html":(localStorage.setItem("resize_api_key",t.resize_api_key),route("/welcome"))})}),riot.tag2("welcome",'<h1 class="uk-text-center">Welcome aboard</h1> <p class="uk-text-center" style="color: white">This is a landing page ... Nothing special here, replace it by what you want !</p> <p class="uk-text-center" style="color: white">Find me in <code>app/widgets/loading.html.tag</code></p> <h2 class="uk-text-center" style="margin-top:80px"><a href="https://fasty.ovh" target="_blank">Fasty</a> is powered by powerful opensource projects</h2> <div class="uk-container uk-text-center" style="color: white;margin-top:80px"> <div class="uk-column-1-2"> <div class="uk-margin"> <a href="https://www.arangodb.com/" target="_blank"><img src="/static/admin/img/ArangoDB-logo-bg.svg" style="height:90px"></a> <br>ArangoDB </div> <div class="uk-margin"> <a href="https://openresty.org/en/" target="_blank"><img src="/static/admin/img/logo.png" style="height:90px"></a> <br>openresty </div> </div> <div class="uk-column-1-2"> <div class="uk-margin"> <a href="https://riot.js.org/" target="_blank"><img src="/static/admin/img/square.svg" style="height:90px"></a> <br>RiotJS </div> <div class="uk-margin"> <a href="https://leafo.net/lapis/" target="_blank"><img src="/static/admin/img/lapis.jpg" style="height:90px"></a> <br>LAPIS </div> </div> </div> </div>',"","",function(t){}),riot.tag2("rightnav",'<ul class="uk-navbar-nav"> <li><a onclick="{deploy}" if="{settings.deploy_secret != ⁗⁗}">Deploy</a></li> <li each="{lang in langs}" class="{lang == window.localStorage.getItem(\'foxx-locale\') ? \'uk-active\' : \'\'}"><a onclick="{changeLang}">{lang}</a></li> <li><a href="#logout"><i class="uk-icon-sign-out"></i> Logout</a></li> </ul>',"","",function(t){this.settings={};var e=this;common.get(url+"/settings",function(t){e.settings=t.data,e.langs=e.settings.langs.split(","),_.includes(e.langs,window.localStorage.getItem("foxx-locale"))||window.localStorage.setItem("foxx-locale",e.langs[0]),e.update()}),this.changeLang=function(t){window.localStorage.setItem("foxx-locale",t.item.lang),document.location.reload()}.bind(this),this.deploy=function(t){if(t.preventDefault(),confirm("Are you sure?")){var a="/deploy";$.post(a,{token:e.settings.token},function(t){"site deployed"==t&&UIkit.notification({message:"Site Deployed Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})})}return!1}.bind(this)})}),require.register("widgets/login.html.tag",function(t,e,a){riot.tag2("loading",'<div class="uk-text-center"> Loading app ... <br><div uk-spinner></div> </div>',"","",function(t){route("/login")}),riot.tag2("login",'<div class="uk-container uk-container-center"> <div uk-grid class="uk-grid-small uk-child-width-1-3@s uk-flex-center uk-text-center"> <div> <h1 class="uk-margin-large-top"><i class="uk-icon-sign-in"></i> Connection</h1> <form class="uk-form uk-margin-top" onsubmit="{save_form}"> <div class="uk-margin"> <input placeholder="Email" class="uk-input" id="username" name="username" value="" type="email"> </div> <div class="uk-margin"> <input type="password" class="uk-input" placeholder="Mot de passe" class="uk-input" id="password" name="password" value=""> </div> <hr> <div class="uk-margin"> <button type="submit" class="uk-button uk-button-primary">Connection</button> </div> <div class="uk-margin-small"> <div id="login_error" class="uk-alert uk-alert-danger uk-hidden uk-text-center"> Bad login or password </div> </div> </form> </div> </div> </div>',"","",function(t){this.save_form=function(t){t.preventDefault(),common.post(url+"auth/login",JSON.stringify({username:$("#username").val(),password:$("#password").val()}),function(t){t.success?document.location.href="index.html":$("#login_error").removeClass("uk-hidden")})}.bind(this)})}),require.register("widgets/settings.html.tag",function(t,e,a){riot.tag2("settings",'<h3 if="{can_access}">settings</h3> <form onsubmit="{save_form}" id="form_settings"> </form> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.can_access=!1,this.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_settings","settings",a.obj._key)}.bind(this);var a=this;common.get(url+"settings/",function(t){a.obj=t.data,common.get(url+"/auth/whoami",function(i){e.update(),e.loaded=!0,e.can_access=void 0===t.roles||_.includes(t.roles.write,i.role),e.can_access&&common.buildForm(a.obj,t.fields,"#form_settings"),e.update()})}),this.on("updated",function(){$(".select_list").select2(),$(".select_tag").select2({tags:!0})})})}),require.register("widgets/uploads.html.tag",function(t,e,a){riot.tag2("images",'<div class="sortable_{opts.field}" style="user-select: none;" uk-sortable="group: upload"> <virtual each="{row in data}"> <div uk-grid class="uk-grid-small" data-id="{row._key}"> <div class="uk-width-1-5"><a href="{row.url}?_from={from}" target="_blank"><img riot-src="{row.url}" alt="" style="max-width: 100%"></a></div> <div class="uk-width-3-5">{row.filename.split(\'/\')[row.filename.split(\'/\').length - 1]}<br>{prettyBytes(row.length)}</div> <div class="uk-width-1-5 uk-text-center"><a onclick="{delete_asset}" uk-icon="icon: trash"></a></div> </div> </virtual> </div>',"images div, images span { color: white; }","",function(t){
var e=this;this.from=btoa(subdomain),this.data=[];var a="";"undefined"!=t.i18n&&(a="/"+window.localStorage.getItem("foxx-locale")),this.load=function(){common.get(url+"uploads/"+t.id+"/"+t.field+a,function(t){e.data=t,e.update()})}.bind(this),this.load(),$(function(){UIkit.util.on(".sortable_"+t.field,"moved",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i,field:t.field}),function(t){t.success&&UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"})})}),UIkit.util.on(".sortable_"+t.field,"added",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i,field:t.field}),function(t){t.success&&(eventHub.trigger("refresh_uploads"),UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"}))})})}),eventHub.on("refresh_uploads",function(){e.load()}),this.delete_asset=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"uploads/"+t.item.row._key,function(){$("[data-id="+t.item.row._key+"]").remove()})},function(){})}.bind(this)}),riot.tag2("files",'<div class="sortable_{opts.field}" style="user-select: none;"> <virtual each="{row in data}"> <div uk-grid class="uk-grid-small" data-id="{row._key}"> <div class="uk-width-3-5">{row.filename} <a href="{row.url}?_from={from}" target="_blank"><i class="fas fa-external-link-alt"></i></a></div> <div class="uk-width-1-5 uk-text-right">{prettyBytes(row.length)}</div> <div class="uk-width-1-5 uk-text-center"><a onclick="{delete_asset}" uk-icon="icon: trash"></a></div> </div> </div>',"files div, files span { color: white; }","",function(t){var e=this;this.from=btoa(subdomain),this.data=[];var a="";"undefined"!=t.i18n&&(a="/"+window.localStorage.getItem("foxx-locale")),common.get(url+"uploads/"+t.id+"/"+t.field+a,function(t){e.data=t,e.update()}),this.filename=function(t){return t.path.split("/").slice(2).join("/")}.bind(this),$(function(){UIkit.sortable(".sortable_"+t.field,{}),UIkit.util.on(".sortable_"+t.field,"moved",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i}),function(t){t.success&&UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"})})})}),this.delete_asset=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"uploads/"+t.item.row._key,function(){$("[data-id="+t.item.row._key+"]").remove()})},function(){})}.bind(this)})}),require.alias("node-browser-modules/node_modules/process/browser.js","process"),t=require("process"),require.register("___globals___",function(t,e,a){window.$=e("jquery"),window.jQuery=e("jquery"),window.riot=e("riot"),window.route=e("riot-route"),window.prettyBytes=e("pretty-bytes")})}(),require("___globals___");