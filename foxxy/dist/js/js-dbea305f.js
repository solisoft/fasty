!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},a={},i={},o={}.hasOwnProperty,s=/^\.\.?(\/|$)/,l=function(t,e){for(var a,i=[],o=(s.test(e)?t+"/"+e:e).split("/"),l=0,n=o.length;l<n;l++)a=o[l],".."===a?i.pop():"."!==a&&""!==a&&i.push(a);return i.join("/")},n=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e){return function(a){var i=l(n(e),a);return t.require(i,e)}},r=function(t,e){var i=g&&g.createHot(t),o={id:t,exports:{},hot:i};return a[t]=o,e(o.exports,c(t),o),o.exports},u=function(t){var e=i[t];return e&&t!==e?u(e):t},d=function(t,e){return u(l(n(t),e))},m=function(t,i){null==i&&(i="/");var s=u(t);if(o.call(a,s))return a[s].exports;if(o.call(e,s))return r(s,e[s]);throw new Error("Cannot find module '"+t+"' from '"+i+"'")};m.alias=function(t,e){i[e]=t};var f=/\.[^.\/]+$/,p=/\/index(\.[^\/]+)?$/,h=function(t){if(f.test(t)){var e=t.replace(f,"");o.call(i,e)&&i[e].replace(f,"")!==e+"/index"||(i[e]=t)}if(p.test(t)){var a=t.replace(p,"");o.call(i,a)||(i[a]=t)}};m.register=m.define=function(t,i){if(t&&"object"==typeof t)for(var s in t)o.call(t,s)&&m.register(s,t[s]);else e[t]=i,delete a[t],h(t)},m.list=function(){var t=[];for(var a in e)o.call(e,a)&&t.push(a);return t};var g=t._hmr&&new t._hmr(d,m,e,a);m._cache=a,m.hmr=g&&g.wrap,m.brunch=!0,t.require=m}}(),function(){var t;"undefined"==typeof window?this:window;require.register("index.html",function(t,e,a){}),require.register("js/common.js",function(t,e,a){var i={init:function(){$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}},startEditor:function(t,e,a){var i=ace.edit(t);i.setTheme("ace/theme/twilight"),i.getSession().setMode(e),i.setOptions({tabSize:2,useSoftTabs:!0}),i.getSession().setUseWrapMode(!0),i.getSession().setValue(unescape($("#"+a).val())),i.getSession().on("change",function(){$("#"+a).val(i.getSession().getValue())})},checkConditions:function(t,e){_.each(t,function(t){t["if"]&&($("#"+t["if"][0]).val()!=t["if"][1]?$("#field_"+t.n).hide():$("#field_"+t.n).show())})},buildForm:function(t,e,a,i,o){var s="",l=[],n=this,c=[],r=[],u=[],d=[],m=[],f=!1,p=[],h="",g=0,k="";if(e.forEach(function(e,a){if(e.tab)g>0&&(s+="</div>"),0==f&&(s+="<ul uk-tab>"),0==f&&(p=[]),f=!0,s+='<li><a href="#">'+e.tab+"</a></li>",""!=s&&(p.push(k),k=""),h=e.id,g=0;else if(void 0!==e.h)k+='<div class="uk-grid uk-grid-small uk-margin-top"><h3>'+e.h+"</h3></div>";else{e.r&&g>0&&(k+="</div>"),e.r&&(k+='<div class="uk-grid uk-grid-small">'),e.c&&e.c.indexOf("uk-width")==-1&&(e.c="uk-width-"+e.c);var i=e.j;t._key&&e.ju&&(i=e.ju);var o="";"hidden"===e.t&&(o="uk-hidden"),k+='<div class="'+e.c+" "+o+'" id="field_'+e.n+'">';var n=e.l;_.isString(i)?i.indexOf("required")>0&&(n="<strong>"+n+"*</strong>"):i&&"required"===i._flags.presence&&(n="<strong>"+n+"*</strong>"),("file"!==e.t&&"image"!==e.t||void 0!==t._id)&&(k+='<label for="" class="uk-form-label">'+n+"</label>");var v=t[e.n];if(e.tr&&t[e.n]&&(v=t[e.n][window.localStorage.getItem("foxx-locale")]),void 0===v&&(v=""),e.t.match(/string/)&&(k+='<input type="'+(2==e.t.split(":").length?e.t.split(":")[1]:"text")+'" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,v])),e.t.match(/password/)&&(k+='<input type="password" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>'),"integer"===e.t&&(k+='<input type="number" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="'+v+'" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,v])),"float"===e.t&&(k+='<input type="text" id="'+e.n+'" class="uk-input" name="'+e.n+'" value="'+v+'" autocomplete="off"><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,v])),"hidden"===e.t&&(k+='<input type="hidden" id="'+e.n+'"  name="'+e.n+'"  value="'+v+'"></div><div data-hint="'+e.n+'">'),"date"===e.t&&(k+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="date" id="'+e.n+'" data-date-format="YYYY/MM/DD" class="uk-input" name="'+e.n+'"  value="'+v+'"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"datetime"===e.t&&(v=v.replace(":00.000",""),k+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="text" id="'+e.n+'" class="uk-input datepicker-here" data-language="en" name="'+e.n+'"  value="'+v+'" autocomplete="off"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"time"===e.t&&(k+='<div><div class="uk-inline"><span class="uk-form-icon" uk-icon="icon: calendar"></span><input type="time" id="'+e.n+'" class="uk-input" name="'+e.n+'"  value="'+v+'"></div><div data-hint="'+e.n+'" class="uk-text-danger"></div></div>'),"text"===e.t&&(k+='<textarea id="'+e.n+'" class="uk-textarea" name="'+e.n+'" style="'+e.s+'">'+v+'</textarea><div data-hint="'+e.n+'" class="uk-text-danger"></div>'),"wysiwyg"===e.t&&(d.push(e.n),k+='<textarea id="'+e.n+'" name="'+e.n+'" ></textarea><div data-hint="'+e.n+'" class="uk-text-danger"></div>',r.push([e.n,v])),e.t.match(/^code/)&&(k+='<input type="hidden" id="'+e.n+'" name="'+e.n+'" value="">',r.push([e.n,v]),k+='<div id="editor_'+e.n+'" class="editor" style="'+e.s+'"></div>',c.push(["editor_"+e.n,"ace/mode/"+e.t.split(":")[1],e.n])),"html"==e.t&&(k+='<input type="hidden" id="'+e.n+'" name="'+e.n+'" value="">',k+='<div id="html_editor_'+e.n+'" data-name="'+e.n+'" class="html_editor" style="'+e.s+'"></div>',m.push([e.n,v])),"list"===e.t&&(k+='<select name="'+e.n+'" style="width:100%" class="uk-select select_list" id="'+e.n+'">',e.d.forEach(function(t){selected="",v===t[0]&&(selected="selected='selected'"),k+='<option value="'+t[0]+'" '+selected+">"+t[1]+"</option>"}),k+="</select>"),"multilist"===e.t&&(k+='<select name="'+e.n+'" style="width:100%" class="uk-select select_mlist" multiple="multiple" id="'+e.n+'">',e.d.forEach(function(t){selected="",v&&v.indexOf(t[0])>=0&&(selected="selected='selected'"),k+='<option value="'+t[0]+'" '+selected+">"+t[1]+"</option>"}),k+="</select>"),"tags"===e.t){k+='<select name="'+e.n+'" style="width:100%" class="select_tag" multiple="multiple">';var b=_.filter(e.d[0],function(t){return"undefined"!=t});e.tr&&(b=_.flatten(_.map(b,function(t){return t[window.localStorage.getItem("foxx-locale")]}))),_.uniq(b).forEach(function(t){"undefined"!=t&&""!=t&&void 0!=t&&(selected="",v&&v.indexOf(t)>=0&&(selected="selected='selected'"),k+='<option value="'+t+'" '+selected+">"+t+"</option>")}),k+="</select>"}if("map"===e.t&&(""===v&&(v=[0,0]),k+='<div class="uk-text-center" id="'+e.n+'_infos"><span class="uk-label"></span></div>',k+='<div id="map_'+e.n+'" class="map" style="'+e.s+'"></div>',k+='<input id="'+e.n+'_lat" type="hidden" name="'+e.n+'" value="'+v[0]+'" />',k+='<input id="'+e.n+'_lng" type="hidden" name="'+e.n+'" value="'+v[1]+'" />',u.push([e.n,v])),"image"===e.t&&t._id&&(k+='<div id="upload-drop_'+e.n+'" class="js-upload uk-placeholder uk-text-center">',k+='    <span uk-icon="icon: cloud-upload"></span>',k+='    <span class="uk-text-middle">Attach images by dropping them here or</span>',k+="    <div uk-form-custom>",k+='        <input type="file" multiple>',k+='        <span class="uk-link">selecting one</span>',k+="    </div>",k+="</div>",k+='<progress id="progressbar_'+e.n+'" class="uk-progress" value="0" max="100" hidden></progress>',k+='<images i18n="'+e.tr+'" field="'+e.n+'" id="'+t._id+'" />',l.push([t._key,t._id.split("/")[0],e.n,"*.(jpg|jpeg|gif|png)","progressbar_"+e.n,"#upload-drop_"+e.n,e.tr])),"file"===e.t&&t._id&&(k+='<div id="upload-drop_'+e.n+'" class="js-upload uk-placeholder uk-text-center">',k+='    <span uk-icon="icon: cloud-upload"></span>',k+='    <span class="uk-text-middle">Attach binaries by dropping them here or</span>',k+="    <div uk-form-custom>",k+='        <input type="file" multiple>',k+='        <span class="uk-link">selecting one</span>',k+="    </div>",k+="</div>",k+='<progress id="progressbar_'+e.n+'" class="uk-progress" value="0" max="100" hidden></progress>',k+='<files i18n="'+e.tr+'" field="'+e.n+'" id="'+t._id+'" />',l.push([t._key,t._id.split("/")[0],e.n,"*.*","progressbar_"+e.n,"#upload-drop_"+e.n,e.tr])),"boolean"===e.t){var y=t[e.n]===!0?" checked='checked' ":"";k+=' <input name="'+e.n+'" '+y+'  class="uk-checkbox" type="checkbox" value="1"  /> '}k+="</div>",f||(s+=k,k=""),1==e.endtab&&(""!=s&&p.push(k),k="",f=!1,s+='</ul><ul class="uk-switcher">{{'+h+"}}</ul>"),g++}}),s+="</div>",p.length>0){var v="";_.each(p,function(t){""!=t&&(v+="<li>"+t+"</li>")}),s=s.replace("{{"+h+"}}",v)}s+='<hr><div class="uk-grid uk-grid-small uk-text-right"><div class="uk-width-1-1">',void 0!=i&&(s+='<a href="#'+i+'" class="uk-button">Back</a> '),s+='<input type="submit" class="uk-button uk-button-primary" value="Save" /></div></div><hr>',$(a).html(s),$(a).find("select").on("change",function(){n.checkConditions(e,a)}),n.checkConditions(e,a),r.forEach(function(t,e){$(a+" #"+t[0]).val(t[1])}),$(".datepicker-here").datepicker({language:"en",timepicker:!0,timeFormat:"hh:ii",dateFormat:"yyyy-mm-dd"}),m.forEach(function(t,e){if(_.isString(t[1]))try{t[1]=JSON.parse(t[1])}catch(t){}$("#html_editor_"+t[0]).contentEditor({value:t[1].html||""}),$("#"+t[0]).val(JSON.stringify(t[1]))}),c.forEach(function(t,e){n.startEditor(t[0],t[1],t[2])}),d.forEach(function(t,e){$("#"+t).trumbowyg()}),$("button").attr("type","button"),u.forEach(function(t,e){var a=L.map("map_"+t[0],{dragging:!0,tap:!1}).setView(t[1],6);L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"}).addTo(a),a.scrollWheelZoom.disable();var i=L.marker(t[1],{draggable:!0}).addTo(a);$("#"+t[0]+"_infos span").html(t[1].join(", ")),i.on("dragend",function(e){var a=e.target.getLatLng();$("#"+t[0]+"_lat").val(a.lat),$("#"+t[0]+"_lng").val(a.lng),$("#"+t[0]+"_infos span").html([a.lat,a.lng].join(", "))})});var n=this;l.forEach(function(t){n.prepare_upload(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}),riot.mount("images"),riot.mount("files"),riot.update(),void 0!==o&&o()},checkLogin:function(){this.ajax(url+"auth/whoami","GET","",function(t){null===t.username&&(document.location.href="login.html")})},saveForm:function(t,e,a,i){a=a||"",i=i||{};var o=this,s=$("#"+t).serializeObject();_.each(s,function(t,e){"trumbowyg"==e.split("-")[0]&&delete s[e]}),$(".select_tag, .select_mlist").each(function(t,e){"string"==typeof s[$(e).attr("name")]&&(s[$(e).attr("name")]=[s[$(e).attr("name")]])}),$("div[data-hint]").html("");var l="#"+t+" textarea, #"+t+" input, #"+t+" select";$(l).removeClass("uk-form-danger"),$(l).removeClass("uk-form-success"),$(l).addClass("uk-form-success"),o.ajax(url+e+"/"+a,"POST",JSON.stringify(s),function(o){o.errors.length>0?o.errors.forEach(function(t){$("#"+t.path).removeClass("uk-form-success"),$("#"+t.path).addClass("uk-form-danger"),$("div[data-hint="+t.path+"]").html("<div>"+t.message.replace(/"(.*)"/,"").trim()+"</div>")}):(UIkit.notification({message:"Successfully saved!",status:"success",timeout:1e3,pos:"bottom-right"}),""==a&&_.isEmpty(i)&&(a=o.data._key,"datasets"!=e.split("/")[0]&&(e=2==e.split("/").length?e.split("/")[1]:e),route("/"+e+"/"+a+"/edit")),_.isEmpty(i)||void 0!=i.element_id||riot.mount("#"+i.id,_.last(t.split("_"))+"_crud_index",i)),setTimeout(function(){$(l).removeClass("uk-form-success")},300)})},ajax:function(t,e,a,i,o){"undefined"==typeof o&&(o=function(){}),$.ajax({url:t,data:a||"",type:e,beforeSend:function(t){var e=localStorage.getItem("X-Session-Id");null!==e&&(t.setRequestHeader("foxx-locale",localStorage.getItem("foxx-locale")),t.setRequestHeader("X-Session-Id",localStorage.getItem("X-Session-Id")))},success:function(t,e,a){a.getResponseHeader("X-Session-Id")&&localStorage.setItem("X-Session-Id",a.getResponseHeader("X-Session-Id")),i(t)},statusCode:{401:function(){document.location.href="/static/admin/login.html"},500:o(),503:function(){localStorage.removeItem("X-Session-Id"),localStorage.removeItem("foxx-locale"),document.location.href="/static/admin/login.html"}}})},get:function(t,e,a){this.ajax(t,"GET","",e,a)},"delete":function(t,e,a){this.ajax(t,"DELETE","",e,a)},post:function(t,e,a,i){this.ajax(t,"POST",e,a,i)},patch:function(t,e,a,i){this.ajax(t,"PATCH",e,a,i)},put:function(t,e,a,i){this.ajax(t,"PUT",e,a,i)},array_diff:function(t,e){return t.filter(function(t){return e.indexOf(t)<0})},keys:function(t){var e=[];for(var a in t)e.push(a);return e},prepare_upload:function(t,e,a,i,o,s,l){var n=document.getElementById(o);UIkit.upload(s,{url:url+"/uploads/"+t+"/"+e+"/"+a,multiple:!0,allow:i,error:function(){console.log("error",arguments)},beforeSend:function(t){t.headers={"X-Session-Id":localStorage.getItem("X-Session-Id"),"foxx-locale":1==l?localStorage.getItem("foxx-locale"):null}},loadStart:function(t){n.removeAttribute("hidden"),n.max=t.total,n.value=t.loaded},progress:function(t){n.max=t.total,n.value=t.loaded},loadEnd:function(t){n.max=t.total,n.value=t.loaded},completeAll:function(){n.value=100,setTimeout(function(){n.setAttribute("hidden",null),riot.mount("images"),riot.mount("files"),riot.update()},250)}})}};a.exports=i}),require.register("js/config.js",function(t,e,a){var i={".fasty.ovh":"/_db",".inseytel.com":"https://inseytel.com/_db","epic20.world":"/_db"};a.exports=i}),require.register("js/editor.js",function(t,e,a){!function(t){t.fn.contentEditor=function(e){var a,i,o,s,l=t(this).attr("data-name")||"solicms",n=this,c=t.extend({widgets:[{id:"h1",icon:"fas fa-heading",title:"h1"},{id:"h2",icon:"fas fa-heading",title:"h2"},{id:"h3",icon:"fas fa-heading",title:"h3"},{id:"h4",icon:"fas fa-heading",title:"h4"},{id:"h5",icon:"fas fa-heading",title:"h5"},{id:"h6",icon:"fas fa-heading",title:"h6"},{id:"col2",icon:"fas fa-columns",title:"2"},{id:"col3",icon:"fas fa-columns",title:"3"},{id:"col4",icon:"fas fa-columns",title:"4"},{id:"col363",icon:"fas fa-columns",title:"3-6-3"},{id:"col48",icon:"fas fa-columns",title:"4-8"},{id:"col84",icon:"fas fa-columns",title:"8-4"},{id:"text",icon:"fas fa-align-left",title:"text"},{id:"img",icon:"fas fa-image",title:"img"},{id:"slide",icon:"fas fa-images",title:"slide"},{id:"code",icon:"fas fa-code",title:"code"},{id:"video",icon:"fas fa-video",title:"video"},{id:"html5",icon:"fab fa-html5",title:"html5"}]},e),r=0,u=function(t){return window.localStorage.removeItem(t)};u("editor-history");var d=function(t){for(var e="Chocolate lollipop pastry tiramisu. Chocolate cake sweet roll dragée. Cookie halvah tootsie roll cupcake candy canes pie oat cake danish chocolate cake. Cheesecake biscuit powder sweet powder. Chocolate bar lollipop jelly-o chocolate cake. Sweet roll sweet roll cupcake topping chocolate cake. Fruitcake chocolate cake jelly-o. Marzipan candy canes jujubes. Cotton candy candy canes icing sesame snaps chocolate cake toffee liquorice jelly-o. Pastry pastry bear claw toffee. Liquorice biscuit dessert chocolate bar gummies. Carrot cake danish cookie croissant toffee gingerbread sweet roll. Icing danish muffin cheesecake jelly-o sugar plum pastry cotton candy. Chocolate bar pie apple pie chocolate bar cupcake lollipop.".split("."),a=[],i=0;i<t;i++)a.push(e[parseInt(1e3*Math.random()%e.length)]);return a.join(". ")+"."},m=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},f=function(e,a){var i,o,s;switch(r%=3,e){case"h1":i='<div class="sg-row cms_row" data-type="h1"><div class="col-12 cms_col">',o='<h1 data-type="h1" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h1>',s="</div></div>";break;case"h2":i='<div class="sg-row cms_row" data-type="h2"><div class="col-12 cms_col">',o='<h2 data-type="h2" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h2>',s="</div></div>";break;case"h3":i='<div class="sg-row cms_row" data-type="h3"><div class="col-12 cms_col">',o='<h3 data-type="h3" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h3>',s="</div></div>";break;case"h4":i='<div class="sg-row cms_row" data-type="h4"><div class="col-12 cms_col">',o='<h4 data-type="h4" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h4>',s="</div></div>";break;case"h5":i='<div class="sg-row cms_row" data-type="h5"><div class="col-12 cms_col">',o='<h5 data-type="h5" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h5>',s="</div></div>";break;case"h6":i='<div class="sg-row cms_row" data-type="h6"><div class="col-12 cms_col">',o='<h6 data-type="h6" class="drag drop" data-editable="true">Macaroon donut tiramisu sweet roll.</h6>',s="</div></div>";break;case"img":i='<div class="sg-row cms_row" data-type="img"><div class="col-12 cms_col">',o='<div data-type="img" class="drag drop" data-editable="true"><img src="https://via.placeholder.com/1200x600" alt=""></div>',s="</div></div>";break;case"text":i='<div class="sg-row cms_row" data-type="text"><div class="col-12 cms_col">',o='<div data-type="text" class="drag drop" data-editable="true"><p style="text-align: justify;">'+d(5)+"</p></div>",s="</div></div>";break;case"code":var l=[];l.push('<code class="language-html">'+m("<h1>Some html code</h1>")+"</code>"),l.push('<code class="language-javascript">console.log("JS ... really ? ")</code>'),l.push('<code class="language-ruby">puts "I Love Ruby"</code>'),i='<div class="sg-row cms_row" data-type="code"><div class="col-12 cms_col">',o='<div data-type="code" class="drag drop" data-editable="true"><pre>'+l[r]+"</pre></div>",s="</div></div>";break;case"video":var n=["AWKEWqx8OyA","TmDKbUrSYxQ","X8zLJlU_-60"],c='<div style="position:relative;padding-top:56.25%;"><iframe src="https://www.youtube.com/embed/'+n[r]+'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div>';i='<div class="sg-row cms_row" data-type="embed"><div class="col-12 cms_col">',o='<div data-type="embed" class="drag drop" data-editable="true" data-html="'+c.replace(/"/g,"&quot;")+'">'+c+"</div>",s="</div></div>";break;case"html5":i='<div class="sg-row cms_row" data-type="embed"><div class="col-12 cms_col">';var c="<p>HTML5 Code here</p>";o='<div data-type="embed" class="drag drop" data-editable="true" data-html="'+c.replace(/"/g,"&quot;")+'">'+c+"</div>",s="</div></div>";break;case"col2":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col2"><div class="col-6 cms_col"></div><div class="col-6 cms_col"></div></div>',s="";break;case"col3":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col3"><div class="col-4 cms_col"></div><div class="col-4 cms_col"></div><div class="col-4 cms_col"></div></div>',s="";break;case"col4":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col4"><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div><div class="col-3 cms_col"></div></div>',s="";break;case"col282":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col282"><div class="col-2 cms_col"></div><div class="col-8 cms_col"></div><div class="col-2 cms_col"></div><div class="col-3 cms_col"></div></div>',s="";break;case"col363":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col363"><div class="col-3 cms_col"></div><div class="col-6 cms_col"></div><div class="col-3 cms_col"></div></div></div>',s="";break;case"col48":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col48"><div class="col-4 cms_col"></div><div class="col-8 cms_col"></div></div></div>',s="";break;case"col84":i="",o='<div class="sg-row cms_row sub_row drag drop" data-type="col84"><div class="col-8 cms_col"></div><div class="col-4 cms_col"></div></div></div>',s=""}return r++,t(a?i+o+s:o)},p=function(){window.drag=function(e){var i=t(e.target).hasClass("drag")?t(e.target):t(e.target).closest(".drag");i.addClass("dragging"),e.stopPropagation(),a=i,e.dataTransfer.setData("text",""),setTimeout(function(){g()},0)},window.drop=function(e){e.stopPropagation(),e.preventDefault();var i=t(e.target).hasClass("drop")?t(e.target):t(e.target).closest(".drop");if(e.dataTransfer.items){var o=!1,s=e.dataTransfer.items.length;s>1&&(s=1);for(var l=0;l<e.dataTransfer.items.length;l++)if("file"===e.dataTransfer.items[l].kind){o=!0;var n=e.dataTransfer.items[l].getAsFile();if(n.type.indexOf("image")>=0){var c=new FileReader;c.readAsDataURL(n),c.onloadend=function(){base64data=c.result;var e=new FormData;e.append("image",n),e.append("key",localStorage.getItem("resize_api_key")),t.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var a=e.loaded/e.total;t(i).html(parseInt(100*a)+"%")}},!1),e},type:"POST",url:"/file/upload",data:e,processData:!1,contentType:!1,success:function(e){e=JSON.parse(e),setTimeout(function(){var a="<picture>";a+='<source media="(max-width: 480px)" srcset="/asset/r/'+e.filename+"/480.webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='<source media="(max-width: 480px)" srcset="/asset/r/'+e.filename+"/480?_from="+btoa(subdomain)+'">',a+='<source media="(max-width: 799px)" srcset="/asset/r/'+e.filename+"/799.webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='<source media="(max-width: 799px)" srcset="/asset/r/'+e.filename+"/799?_from="+btoa(subdomain)+'">',a+='<source media="(min-width: 800px)" srcset="/asset/o/'+e.filename+".webp?_from="+btoa(subdomain)+'" type="image/webp">',a+='<source media="(min-width: 800px)" srcset="/asset/o/'+e.filename+"?_from="+btoa(subdomain)+'">',a+='<img src="/asset/o/'+e.filename+'">',a+="</picture>",t(i).html(a)},100),b()}})}}}o||(t(".active").removeClass("active"),a.hasClass("cms_col")?i.hasClass("cms_col")?_(a,i):_(a,0==i.children().length?i:i.children().first()):i.hasClass("cms_col")?_(a.children().first(),i):_(a,i),i.removeClass("drop_empty"),i.hasClass("drag")||(k(i),v(i)),t(".drop_empty").remove(),b(),h())}},window.drag_end=function(e){e.stopPropagation(),t(".row_editor").css("margin-left","-99999px"),t(".dragging").removeClass("dragging"),t(".active").removeClass("active"),t(".drop_empty").remove(),b()},window.allow_drop=function(e){e.stopPropagation(),e.preventDefault();var a=t(e.target).hasClass("drop")?t(e.target):t(e.target).closest(".drag");t(".active").removeClass("active"),a.addClass("active")}},h=function(){t(n).find(".cms_row").removeClass("empty_row"),t(n).find(".cms_row").each(function(e,a){""===t(a).text().trim()&&t(a).addClass("empty_row")})},g=function(){b();var e='<div class="sg-row cms_row" data-type="full"><div class="col-12 cms_col"><div class="drop drop_empty row_empty"></div></div></div>',a='<div class="drop drop_empty col_empty"><div></div></div>';t(n).find(".edit-mode .cms_editor .sub_row .cms_col .drop").each(function(e,i){(t(i).parent().hasClass("cms_col")||t(i).parent().hasClass("cms_row"))&&t(i).after(a)}),t(n).find(".edit-mode .page-content > .cms_row").each(function(a,i){t(i).before(e)}),t(n).find(".edit-mode .cms_col").each(function(e,i){t(i).hasClass("col-12")||t(i).prepend(a)}),t(n).find(".edit-mode .cms_editor .page-content").append(e),t(n).find(".edit-mode .drop_empty").attr("ondragover","allow_drop(event)"),t(n).find(".edit-mode .drop_empty").attr("ondrop","drop(event)")},_=function(e,a){e=e[0],a=a[0];const i=a.nextElementSibling,o=a.parentNode;if(t(e).data("menuitem")){var s=f(t(e).data("menuitem"),!1);if(t(a).hasClass("row_empty")){var l=t(s).hasClass("sub_row")?t(o).parent():t(o);l.html(s[0].outerHTML)}else t(a).hasClass("col_empty")?(t(a).html(s[0].outerHTML),t(a).removeClass("row_empty"),t(a).removeClass("col_empty"),t(a).addClass("drag")):t(o).hasClass("sg-container")||t(o).html(s[0].outerHTML);k(t(".drag")),v(t(".drop"))}else{try{const c=e;e.replaceWith(a),o.insertBefore(e,i)}catch(r){o.appendChild(c)}b()}t(n).find("[data-type=full] .col-12").each(function(e,a){if(t(a).find(".sg-row").length>0){var i=t(a).html();t(a).parent()[0].outerHTML=i}})},k=function(t){t.attr("draggable",!0),t.attr("ondragstart","drag(event)"),t.attr("ondragend","drag_end(event)")},v=function(t){t.addClass("drop"),t.attr("ondragover","allow_drop(event)"),t.attr("ondrop","drop(event)")},b=function(){t(n).find(".edit-mode .drop").each(function(e,a){var i=t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;0!=t(a).find(".cms_col").length||i||""!=t(a).text().trim()||"img"==t(a).data("type")||"embed"==t(a).data("type")||t(a).remove(),t(a).hasClass("drop")&&!t(a).hasClass("drag")&&t(a).remove()}),t(n).find(".edit-mode .drag").each(function(e,a){var i=t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;i&&t(a).parent().find(".drag").length>1&&(""==t(a).html().trim()||"<div></div>"==t(a).html().trim())&&!t(a).is("img")&&t(a).remove()}),t(n).find(".edit-mode .cms_row > *").each(function(e,a){t(a).parents().map(function(t,e){return e.className.split(" ")}).filter(function(t,e){return"cms_col"==e}).length>=1;(!t(a).hasClass("cms_col")&&""==t(a).html().trim()||"<div></div>"==t(a).html().trim())&&t(a).remove()}),t(n).find(".edit-mode .cms_row").each(function(e,a){""!=t(a).html().trim()&&"<div></div>"!=t(a).html().trim()&&'<div class="col-12 cms_col"></div>'!=t(a).html().trim()||t(a).remove()})},y=function(e){var a=[];return t(e).find("> .cms_row").each(function(e,i){"full"==t(i).data("type")&&(t(i).find("div:first").hasClass("cms_col")?t(i).data("type",t(i).find("[data-type]").data("type")):i=t(i).children()[0]);var o={data:[],type:t(i).data("type")};t(i).find("> .cms_col").each(function(e,a){var i=[];t(a).find("[data-type]").each(function(e,a){if(void 0==t(a).data("exported")){t(a).data("exported",!0);var o={};o.type=t(a).data("type"),o.attr=t(a).data("attr"),t(a).data("type").indexOf("col")>=0?o.content=y(t(a).parent()):o.content=t(a).html(),i.push(o)}}),o.data.push(i)}),a.push(o)}),t(e).find("[data-exported]").removeAttr("data-exported"),a},w=function(e){t(n).find(".page-content").html(e||""),b(),h(),k(t(n).find(".drag")),k(t(n).find(".drop")),x(),P(),t(n).find("[data-html]").each(function(e,a){t(a).html(t(a).data("html"))})},x=function(){t(n).find(".edit-mode .cms_editor").on("mouseenter",".cms_row",function(){t(n).find(".edit-mode .row_editor").css("margin-left","-99999px");var e=0-t(n).find(".cms_editor").offset().top+t(this).offset().top+t(this).height()-t(n).find(".row_editor").height(),a=t(this).offset().left+16-100;t(n).find(".edit-mode .row_editor").css("margin-left",a+"px"),t(n).find(".edit-mode .row_editor").css("margin-top",e+"px"),i=t(this)}),t(n).find(".edit-mode .cms_editor").on("mouseenter",".cms_col > *",function(){t(this).offset().top,t(this).offset().left-t(n).find("aside").width();i=t(this)}),t(n).find(".edit-mode .cms_row_delete").on("click",function(){return i.closest(".edit-mode .sg-row").remove(),!1}),t(n).find(".edit-mode .page-content").on("click","[data-type]",function(){if(o=t(this),raw_object=t(this.outerHTML),raw_object.data("attr")?(t(n).find("input[data-name=col-class]").val(raw_object.data("attr")["col-class"]),t(n).find("input[data-name=row-class]").val(raw_object.data("attr")["row-class"]),t(n).find("input[data-name=container-class]").val(raw_object.data("attr")["container-class"])):(t(n).find("input[data-name=col-class]").val(""),t(n).find("input[data-name=row-class]").val(""),t(n).find("input[data-name=container-class]").val("")),t(n).find(".editor-code").hide(),t(n).find(".editor-simplecode").hide(),t(n).find(".editor-img-code").hide(),raw_object.data("editable")){t(n).find(".trumbowyg").hide(),t(n).find("#ace-editor-"+l).hide();var e=t(this).html().trim();if(t(n).find(".edit-mode .cms_editor").addClass("editmode"),"text"==raw_object.data("type")&&(t("#trumbowyg-"+l).trumbowyg("html",e),t(n).find(".trumbowyg").show()),"code"==raw_object.data("type")&&(t(n).find(".editor-code").show(),t(n).find("#ace-editor-"+l).show(),t(n).find("input[data-name=lang]").val(raw_object.find("code:first")[0].className.replace("language-","")),s.session.setMode("ace/mode/"+a),s.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0}),s.getSession().setValue(t(this).text())),["embed","h1","h2","h3","h4","h5","h6"].indexOf(raw_object.data("type"))>=0){t(n).find(".editor-simplecode").show(),t("#ace-editor-"+l).show();var a="html";s.session.setMode("ace/mode/"+a),s.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0});var e=t(this).html();"embed"==raw_object.data("type")&&(e=t(this).attr("data-html").replace(/&quot;/g,'"')),s.getSession().setValue(e)}if(["img"].indexOf(o.data("type"))>=0){var i=t(this).find(".img-div").length>0?t(this).find(".img-div"):t(this).find("img").parent();t(n).find(".editor-simplecode").show(),t(n).find(".editor-img-code").show(),t("#ace-editor-"+l).show(),t(n).find("input[data-name=img-width").val(i.attr("data-img-width")),t(n).find("select[data-name=img-alignment").val(i[0].style["text-align"]);var a="html";s.session.setMode("ace/mode/"+a),s.setOptions({maxLines:1/0,tabSize:2,useSoftTabs:!0}),s.getSession().setValue(i[0].innerHTML)}}return!1}),t(n).find(".edit-mode .sg-editcontent").on("click",".fa-times-circle",function(){return t(".edit-mode .cms_editor").removeClass("editmode"),D(),!1}),t(n).find(".edit-mode .addwidget").on("click",function(e){e.preventDefault();var a=f(t(this).data("id"),!0);return t(n).find(".edit-mode .page-content").append(a),t(n).find(".edit-mode .drag").attr("draggable",!0),t(n).find(".edit-mode .drag").attr("ondragstart","drag(event)"),t(n).find(".edit-mode .drag").attr("ondragover","allow_drop(event)"),t(n).find(".edit-mode .drag").attr("ondrop","drop(event)"),t(n).find(".edit-mode .drag").attr("ondragend","drag_end(event)"),h(),!1}),t(n).find(".toggle-layout").on("click",function(e){e.preventDefault(),p(),t(n).find(".view-mode").toggleClass("isactive"),t(n).find(".edit-mode").toggleClass("isactive"),t(n).toggleClass("fullscreen"),t("[data-exported]").removeAttr("data-exported");var a={html:t(n).find(".edit-mode .page-content").html(),json:y(t(n).find(".edit-mode .page-content"))};return t('input[name="'+l+'"]').val(JSON.stringify(a)),t(n).find(".page-content").html(a.html||""),P(),t(n).find("[data-html]").each(function(e,a){t(a).html(t(a).attr("data-html"))}),!1})},P=function(){t(n).find(".view-mode .drag, .view-mode .drop").removeAttr("ondragend").removeAttr("ondragstart").removeAttr("ondragover").removeAttr("ondrop")},S='<a href="" class="toggle-layout view-mode isactive">Edit content</a>';S+='<section class="view-mode isactive">                        <div class="page-content"></div></section>',t(n).append(S);var I='<aside class="edit-mode">                   <div class="sg-container toolbox"><h1>Page tools</h1>                    <div class="sg-row"></div>                   <div class="sg-row"><a href="" class="toggle-layout">Exit</a></div></div>                  </aside>';t(n).append(I),t(n).addClass("editor-cms"),c.widgets.forEach(function(e){t(n).find(".toolbox .sg-row:first").append('      <div class="col-4 drag" dragdraggable="true" data-menuitem="'+e.id+'">        <a href="#" class="addwidget" data-id="'+e.id+'">          <i class="'+e.icon+'"></i>          <div class="small">'+e.title+"</div></a>      </div>")});var $='<section class="edit-mode">      <div class="cms_editor">        <div class="row_editor">          <div class="cms_toolbar">            <ul>              <li><a href="#" class="cms_row_delete"><i class="fas fa-trash-alt"></i></a></li>            </ul>          </div>        </div>        <div class="sg-container page-content"></div>        <div class="sg-editcontent">          <i class="far fa-times-circle" style="float: right;padding: 10px"></i>          <div class="content">            <div id="trumbowyg-'+l+'"></div>            <div><label>Container Class</label><input type="text" data-name="container-class" class="uk-input"></div>            <div><label>Row Class</label><input type="text" data-name="row-class" class="uk-input"></div>            <div><label>Col Class</label><input type="text" data-name="col-class" class="uk-input"></div>            <div class="editor-code"><label>Language</label><input type="text" data-name="lang" class="uk-input"></div>            <div class="uk-grid"><div class="uk-width-1-2 editor-img-code"><label>Image Width</label><input type="text" data-name="img-width" class="uk-input"></div>            <div class="uk-width-1-2 editor-img-code"><label>Image Alignment</label>            <select class="uk-select" data-name="img-alignment">            <option>left</option><option>center</option><option>right</option></select></div></div>            <div class="editor-code editor-simplecode"><label>Code</label><div id="ace-editor-'+l+'" class="ace-editor"></div></div>          </div>        </div>      </div>    </section>';
t(n).append($),w(e.value),t("#trumbowyg-"+l).trumbowyg({btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],resetCss:!0,svgPath:"img/icons.svg",removeformatPasted:!0}).on("tbwchange",function(){o.html(t("#trumbowyg-"+l).trumbowyg("html"))}),s=ace.edit("ace-editor-"+l),s.getSession().setUseWrapMode(!0),s.setTheme("ace/theme/twilight"),s.session.setMode("ace/mode/html");var D=function(){if(o){var e={"col-class":t("input[data-name=col-class]").val(),"row-class":t("input[data-name=row-class]").val(),"container-class":t("input[data-name=container-class]").val()},a=s.getSession().getValue();if("code"==o.data("type")){var i="language-"+t(n).find("input[data-name=lang]").val();o.html('<pre><code class="'+i+'">'+m(a)+"</code></pre>")}if(["h1","h2","h3","h4","h5","h6"].indexOf(o.data("type"))>=0&&o.html(a),["embed"].indexOf(o.data("type"))>=0&&(o.html(a),o.attr("data-html",a)),["text"].indexOf(o.data("type"))>=0&&o.html(t("#trumbowyg-"+l).trumbowyg("html")),["img"].indexOf(o.data("type"))>=0){var c=t(n).find("input[data-name=img-width").val()?t(n).find("input[data-name=img-width").val():"100%",r=t(n).find("select[data-name=img-alignment").val()?t(n).find("select[data-name=img-alignment").val():"left",u=t("<div>").append(t.parseHTML(a));u.each(function(){for(var e=t(this).find("img"),a=0;a<e.length;a++)e[a].style.width=c}),o.html('<div class="img-div" style="text-align: '+r+'" data-img-width="'+c+'">'+u[0].innerHTML+"</div>")}o.attr("data-attr",JSON.stringify(e))}};return this}}(jQuery)}),require.register("js/js.js",function(t,e,a){document.removeEventListener("keydown",function(){}),document.addEventListener("keydown",function(t){83==t.keyCode&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&(t.preventDefault(),$("input[type=submit]:visible").click())},!1),$(function(){riot.mount("rightnav"),route("/",function(t){riot.mount("div#app","loading")}),route("/welcome",function(t){riot.mount("div#app","welcome")}),route("/login",function(t){riot.mount("div#app","login")}),route("/signup",function(t){riot.mount("div#app","signup")}),route("/confirm/*",function(t){common.post(url+"auth/confirm",JSON.stringify({uuid:t}),function(){document.location.href="index.html"})}),route("/logout",function(t){common.post(url+"auth/logout","",function(t){localStorage.removeItem("X-Session-Id"),document.location.href="login.html"})}),route("/layouts",function(){riot.mount("div#app","layouts")}),route("/pages",function(){riot.mount("div#app","pages")}),route("/pages/*",function(t){riot.mount("div#app","pages",{folder_key:t})}),route("/partials",function(){riot.mount("div#app","partials")}),route("/partials/*",function(t){riot.mount("div#app","partials",{folder_key:t})}),route("/components",function(){riot.mount("div#app","components")}),route("/components/*",function(t){riot.mount("div#app","components",{folder_key:t})}),route("/spas",function(){riot.mount("div#app","spas")}),route("/redirections",function(){riot.mount("div#app","redirections")}),route("/trads",function(){riot.mount("div#app","trads")}),route("/settings",function(){riot.mount("div#app","settings")}),route("/datatypes",function(){riot.mount("div#app","datatypes")}),route("/datatypes/*",function(t){riot.mount("div#app","datatypes",{folder_key:t})}),route("/users",function(){riot.mount("div#app","users")}),route("/aqls",function(){riot.mount("div#app","aqls")}),route("/helpers",function(){riot.mount("div#app","helpers")}),route("/apis",function(){riot.mount("div#app","apis")}),route("/scripts",function(t){riot.mount("div#app","scripts")}),route("/datasets/*",function(t){riot.mount("div#app","datasets",{datatype:t})}),route("/datasets/*/new",function(t){riot.mount("div#app","dataset_new",{datatype:t})}),route("/datasets/*/*",function(t,e){riot.mount("div#app","datasets",{datatype:t,folder_key:e})}),route("/datasets/*/new/*",function(t,e){riot.mount("div#app","dataset_new",{datatype:t,folder_key:e})}),route("/datasets/*/*/edit",function(t,e){riot.mount("div#app","dataset_edit",{datatype:t,dataset_id:e})}),route(function(t,e,a){void 0!=a&&("layouts"==t&&"edit"==a&&riot.mount("div#app","layout_edit",{layout_id:e}),"pages"==t&&("edit"==a&&riot.mount("div#app","page_edit",{page_id:e}),"new"==a&&riot.mount("div#app","page_new",{folder_key:e})),"partials"==t&&("edit"==a&&riot.mount("div#app","partial_edit",{partial_id:e}),"new"==a&&riot.mount("div#app","partial_new",{folder_key:e})),"components"==t&&("edit"==a&&riot.mount("div#app","component_edit",{component_id:e}),"new"==a&&riot.mount("div#app","component_new",{folder_key:e})),"spas"==t&&"edit"==a&&riot.mount("div#app","spa_edit",{spa_id:e}),"redirections"==t&&"edit"==a&&riot.mount("div#app","redirection_edit",{redirection_id:e}),"trads"==t&&"edit"==a&&riot.mount("div#app","trad_edit",{trad_id:e}),"datatypes"==t&&("edit"==a&&riot.mount("div#app","datatype_edit",{datatype_id:e}),"new"==a&&riot.mount("div#app","datatype_new",{folder_key:e})),"users"==t&&"edit"==a&&riot.mount("div#app","user_edit",{user_id:e}),"aqls"==t&&"edit"==a&&riot.mount("div#app","aql_edit",{aql_id:e}),"helpers"==t&&"edit"==a&&riot.mount("div#app","helper_edit",{helper_id:e}),"apis"==t&&"edit"==a&&riot.mount("div#app","api_edit",{api_id:e}),"scripts"==t&&"edit"==a&&riot.mount("div#app","script_edit",{script_id:e}))}),route(function(t,e){"layouts"==t&&"new"==e&&riot.mount("div#app","layout_new"),"pages"==t&&"new"==e&&riot.mount("div#app","page_new"),"partials"==t&&"new"==e&&riot.mount("div#app","partial_new"),"components"==t&&"new"==e&&riot.mount("div#app","component_new"),"spas"==t&&"new"==e&&riot.mount("div#app","spa_new"),"redirections"==t&&"new"==e&&riot.mount("div#app","redirection_new"),"trads"==t&&"new"==e&&riot.mount("div#app","trad_new"),"datatypes"==t&&"new"==e&&riot.mount("div#app","datatype_new"),"users"==t&&"new"==e&&riot.mount("div#app","user_new"),"aqls"==t&&"new"==e&&riot.mount("div#app","aql_new"),"helpers"==t&&"new"==e&&riot.mount("div#app","helper_new"),"apis"==t&&"new"==e&&riot.mount("div#app","api_new"),"scripts"==t&&"new"==e&&riot.mount("div#app","script_new")}),route.start(!0),document.location.host.indexOf("prod.")>=0&&$("body").css("background","linear-gradient(150deg,#370d13 0,#283a63 100%)"),document.location.host.indexOf("staging.")>=0&&$("body").css("background","linear-gradient(150deg,#33521c 0,#283a63 100%)"),document.location.host.indexOf("qa.")>=0&&$("body").css("background","linear-gradient(150deg, rgb(61, 64, 18) 0px, rgb(37, 43, 2) 100%)")})}),require.register("widgets/apis.html.tag",function(t,e,a){riot.tag2("api_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"api_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/"+t.parent_name+"/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"api_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("api_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_api"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"api_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_api","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.api=a.data,common.buildForm(e.api,t.fields,"#"+t.id+"_crud_api")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("api_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_api"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"api_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_api")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_api","cruds/sub/apis/"+t.id,"",t)}.bind(this)}),riot.tag2("api_edit",'<virtual if="{can_access}"> <div uk-alert class="uk-alert-warning" if="{locked_by}"> <i class="fas fa-lock"></i> This file is locked by {locked_by} </div> <ul uk-tab> <li><a href="#">apis</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing api</h3> <form onsubmit="{save_form}" class="uk-form" id="form_api"> </form> <a onclick="{install}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-upload"></i> Install</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.settings={},e.locked_by=null,common.get(url+"/settings",function(t){e.settings=t.data}),this.save_form=function(e){e.preventDefault(),common.saveForm("form_api","cruds/apis",t.api_id)}.bind(this),this.install=function(t){t.preventDefault();var a="/service/"+e.api.name;return $.post(a,{token:e.settings.token},function(t){"service installed"==t&&UIkit.notification({message:"Endpoint Deployed Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})}),!1}.bind(this),common.get(url+"/cruds/apis/"+t.api_id,function(a){e.api=a.data,e.locked_by=a.data.locked_by,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.api,i,"#form_api","apis",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"api_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.api_id,parent_name:"apis"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("api_new",'<virtual if="{can_access}"> <h3>Creating api</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_api"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_api","cruds/apis")}.bind(this),common.get(url+"/cruds/apis/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_api","apis")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("apis",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#apis/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New api</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing apis</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="110"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="160"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{install}" class="uk-button uk-button-success uk-button-small"><i class="fas fa-upload"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.settings={},common.get(url+"/settings",function(t){e.settings=t.data}),this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/apis/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/apis/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/apis/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/apis/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){return t.preventDefault(),common.patch(url+"/cruds/apis/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)}),!1}.bind(this),this.install=function(t){t.preventDefault();var a="/service/"+t.item.row.name;return $.post(a,{token:e.settings.token},function(t){"service installed"==t&&UIkit.notification({message:"Endpoint Deployed Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})}),!1}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/apis/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","apis.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/apis/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/aqls.html.tag",function(t,e,a){riot.tag2("aql_edit",'<virtual if="{can_access}"> <div uk-alert class="uk-alert-warning" if="{locked_by}"> <i class="fas fa-lock"></i> This file is locked by {locked_by} </div> <ul uk-tab> <li><a href="#">aqls</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing aql</h3> <form onsubmit="{save_form}" class="uk-form" id="form_aql"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.locked_by=null,this.save_form=function(e){e.preventDefault(),common.saveForm("form_aql","cruds/aqls",t.aql_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/aqls/"+e.aql._key+"/duplicate",function(t){route("/aqls/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/aqls/"+t.aql_id,function(a){e.aql=a.data,e.locked_by=a.data.locked_by,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.aql,i,"#form_aql","aqls",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"aql_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.aql_id,parent_name:"aqls"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("aql_new",'<virtual if="{can_access}"> <h3>Creating aql</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_aql"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_aql","cruds/aqls")}.bind(this),common.get(url+"/cruds/aqls/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_aql","aqls")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("aqls",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#aqls/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New aql</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing aqls</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/aqls/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/aqls/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/aqls/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/aqls/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/aqls/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/aqls/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","aqls.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/aqls/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/components.html.tag",function(t,e,a){riot.tag2("component_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#components/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#components/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(t){common.get(url+"/cruds/folders/components/"+t,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(t){var i=prompt("Folder's name");common.post(url+"/cruds/folders/components",JSON.stringify({name:i,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(t){var a=prompt("Update Folder's name");common.patch(url+"/cruds/folders/components",JSON.stringify({name:a,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(t){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var t=_.last(_.initial(e.path));common["delete"](url+"/cruds/folders/components/"+e.folder._key,function(i){common.get(url+"/cruds/folders/components/"+t._key,function(i){e.folders=i.folders,e.path=i.path,a(t._key),e.update()})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("component_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{component > 0}"><a onclick="{previouspage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(component + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextpage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"component_crud_new",t)}.bind(this),this.loadcomponent=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/component/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadcomponent(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"component_crud_edit",t)}.bind(this),this.nextpage=function(t){t.preventDefault(),e.component+=1,e.loadcomponent(e.component+1)}.bind(this),this.previouspage=function(t){t.preventDefault(),e.component-=1,e.loadcomponent(e.component+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadcomponent(1)})},function(){})}.bind(this)}),riot.tag2("component_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_component"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"component_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_component","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.component=a.data,common.buildForm(e.component,t.fields,"#"+t.id+"_crud_component")}),
this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("component_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_component"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"component_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_component")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_component","cruds/sub/components/"+t.id,"",t)}.bind(this)}),riot.tag2("component_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">components</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing component</h3> <form onsubmit="{save_form}" class="uk-form" id="form_component"> </form> <a class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this component... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_component","cruds/components",t.component_id)}.bind(this),this.duplicate=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/components/"+t.component_id+"/duplicate",function(t){route("/components/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.publish=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/cruds/components/"+t.component_id+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/cruds/components/"+t.component_id,function(a){e.component=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields,o=a.fields.act_as_tree;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(s){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,s.role),e.loaded=!0,e.update();var l="components";o&&(l="components/"+e.component.folder_key),e.can_access&&common.buildForm(e.component,i,"#form_component",l,function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"component_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.component_id,parent_name:l})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("component_new",'<virtual if="{can_access}"> <h3>Creating component</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_component"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this component... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_component","cruds/components")}.bind(this),common.get(url+"/cruds/components/fields",function(a){common.get(url+"/auth/whoami",function(i){if(e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var o=a.fields,s={};_.isArray(o)||(o=o.model);var l="components";e.opts.folder_key&&(o.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),s.folder_key=t.folder_key,l="components/"+t.folder_key),common.buildForm(s,o,"#form_new_component",l)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("components",'<component_folders show="{loaded}" folder_key="{folder_key}"></component_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#components/{folder._key}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New component</a> <a if="{!act_as_tree}" href="#components/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New component</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing components</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{component > 0}"><a onclick="{previouspage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(component + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextpage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per component : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setperpage}" class="uk-label">25</a> <a onclick="{setperpage}" class="uk-label">50</a> <a onclick="{setperpage}" class="uk-label">100</a> <a onclick="{setperpage}" class="uk-label">500</a> <a onclick="{setperpage}" class="uk-label">1000</a> <a onclick="{setperpage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this component... </virtual>',"","",function(t){var e=this;this.component=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder={},this.folder_key=this.opts.folder_key||"",this.act_as_tree=!0,this.loadcomponent=function(t){e.loaded=!1;var a="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/cruds/components/page/"+t+"/"+this.perpage+a,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.setFolder=function(t){e.folder=t,e.act_as_tree=""!==t,e.loadcomponent(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/components/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadcomponent(1)}.bind(this),this.edit=function(t){route("/components/"+t.item.row._key+"/edit")}.bind(this),this.nextpage=function(t){e.component+=1,e.loadcomponent(e.component+1)}.bind(this),this.previouspage=function(t){e.component-=1,e.loadcomponent(e.component+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/components/"+t.item.row._key,function(){e.loadcomponent(e.component+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/components/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setperpage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadcomponent(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/components/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","components.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){var a="?folder_key="+e.folder._key;e.act_as_tree||(a=""),common.put(url+"cruds/components/orders/"+t.oldIndex+"/"+t.newIndex+a,{},function(){})}})}})})}),require.register("widgets/datasets.html.tag",function(t,e,a){riot.tag2("dataset_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#datasets/{opts.slug}/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#datasets/{opts.slug}/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(a){common.get(url+"/cruds/folders/datasets_"+t.slug+"/"+a,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(i){var o=prompt("Folder's name");common.post(url+"/cruds/folders/datasets_"+t.slug,JSON.stringify({name:o,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(a){var i=prompt("Update Folder's name");common.patch(url+"/cruds/folders/datasets_"+t.slug,JSON.stringify({name:i,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(a){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var a=_.last(_.initial(e.path));common["delete"](url+"/cruds/folders/datasets_"+t.slug+"/"+e.folder._key,function(e){common.get(url+"/cruds/folders/datasets_"+t.slug+"/"+a._key,function(e){route("/datasets/"+t.slug+"/"+a._key)})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("dataset_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th width="20" if="{sortable}"></th> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody id="sublist"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){this.sortable=!1,this.data=[];var e=this;this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"datasets/"+t.parent_name+"/"+t.parent_id+"/"+t.model+"/page/"+a+"/"+per_page,function(t){e.data=t.data[0].data;var a=t.model;e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),a.columns&&(e.cols=a.columns),e.sortable=!!a.sortable,e.count=t.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"dataset_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){t.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/datasets/datasets/"+t.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this),this.on("updated",function(){if(e.sortable){var a=document.getElementById("sublist");if(a){new Sortable(a,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(e){common.put(url+"datasets/"+t.id+"/orders/"+e.oldIndex+"/"+e.newIndex,{},function(){})}})}}})}),riot.tag2("dataset_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_{opts.singular}"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_"+t.singular,"datasets/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"")}.bind(this);var e=this;common.get(url+"/datasets/"+t.parent_name+"/sub/"+t.id+"/"+t.element_id,function(a){e.subdata=a.data,common.buildForm(e.subdata,t.fields,"#"+t.id+"_crud_"+t.singular)}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_dataset"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"dataset_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_dataset")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_dataset","datasets/"+t.parent_name+"/"+t.parent_id+"/"+t.id,"",t)}.bind(this)}),riot.tag2("all_datatypes",'<div class="rightnav uk-card uk-card-default uk-card-body"> <ul class="uk-nav-default uk-nav-parent-icon" uk-nav> <li class="uk-nav-header">Datasets</li> <li each="{datatypes}"><a href="#datasets/{slug}">{name}</a></li> </ul> </div>',"","",function(t){var e=this;this.datatypes=[],common.get(url+"/datasets/datatypes",function(t){e.datatypes=t,e.update()})}),riot.tag2("dataset_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">datasets</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing {opts.datatype}</h3> <form onsubmit="{save_form}" class="uk-form" id="form_dataset"> </form> <a if="{publishable}" class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.sub_models=[],e.publishable=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_dataset","datasets/"+t.datatype,t.dataset_id)}.bind(this),this.duplicate=function(a){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/datasets/"+t.datatype+"/"+e.dataset._key+"/duplicate",function(e){route("/datasets/"+t.datatype+"/"+e._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.publish=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/datasets/"+e.dataset._key+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/datasets/"+t.datatype+"/"+t.dataset_id,function(a){e.publishable=a.model.publishable,e.dataset=a.data,e.fields=a.fields,e.sub_models=a.model.sub_models;var i=a.model.act_as_tree;_.isArray(e.fields)||(fields=fields.model),common.get(url+"/auth/whoami",function(o){if(localStorage.setItem("resize_api_key",o.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access)var s="datasets/"+t.datatype;i&&e.dataset.folder_key&&(s+="/"+e.dataset.folder_key),common.buildForm(e.dataset,e.fields,"#form_dataset",s,function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"dataset_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.dataset_id,parent_name:t.datatype})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_new",'<virtual if="{can_access}"> <h3>Creating {opts.datatype}</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_dataset"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_new_dataset","datasets/"+t.datatype)}.bind(this),common.get(url+"/datasets/"+t.datatype+"/fields",function(a){common.get(url+"/auth/whoami",function(i){if(localStorage.setItem("resize_api_key",i.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var o=a.fields,s={},l="datasets/"+t.datatype;e.opts.folder_key&&(o.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),s.folder_key=t.folder_key,l+="/"+t.folder_key),common.buildForm(s,o,"#form_new_dataset",l)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("dataset_tags",'<span each="{row in data}"> {row.tag} <span class="uk-badge uk-margin-right">{row.size}</span> </span>',"","",function(t){var e=this;common.get(url+"/datasets/"+t.datatype+"/stats/"+this.opts.tag,function(t){e.data=t,e.update()})}),riot.tag2("datasets",'<dataset_folders show="{loaded}" if="{act_as_tree}" folder_key="{folder_key}" slug="{opts.datatype}"></dataset_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#datasets/{opts.datatype}/new/{folder_key}" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i></a> <a if="{!act_as_tree}" href="#datasets/{opts.datatype}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i></a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing {opts.datatype}</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <dataset_tags if="{show_stats}" datatype="{opts.datatype}" tag="{show_stats_tag}"></dataset_tags> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}" class="{col.class}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}" no-reorder> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{calc_value(row, col, locale)} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination noselect"> <li if="{page + 1 > 1}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.show_stats=!1,this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder_key=this.opts.folder_key||"",this.folder={},this.act_as_tree=!0,this.loadPage=function(a){e.loaded=!1;var i="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/datasets/"+t.datatype+"/page/"+a+"/"+this.perpage+i,function(t){e.data=t.data[0].data;var a=t.model;e.act_as_tree=a.act_as_tree,a.stats_for_tag&&(e.show_stats=!0,e.show_stats_tag=a.stats_for_tag,e.update()),e["export"]=!!a["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),a.columns&&(e.cols=a.columns),e.count=t.data[0].count,e.sortable=!!a.sortable,common.get(url+"/auth/whoami",function(t){localStorage.setItem("resize_api_key",t.resize_api_key),e.loaded=!0,e.can_access=void 0===a.roles||_.includes(a.roles.read,t.role),e.update()})})},this.setFolder=function(t){e.folder=t||{},e.folder_key=e.folder._key,e.loadPage(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(a){a.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/datasets/"+t.datatype+"/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/datasets/"+this.opts.datatype+"/"+t.item.row._key+"/edit")}.bind(this),this.new_dataset=function(t){route("/datasets/"+this.opts.datatype+"/new")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/datasets/"+t.datatype+"/"+a.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(e){e.preventDefault(),common.patch(url+"/datasets/"+t.datatype+"/"+e.target.dataset.key+"/"+e.item.col.name+"/toggle","{}",function(t){t.success&&(e.target.innerText=t.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,localStorage.setItem("perpage",e),this.loadPage(1)}.bind(this),this.export_data=function(e){common.get(url+"/datasets/"+t.datatype+"/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","datasets.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var a=document.getElementById("list");new Sortable(a,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(a){var i="?folder_key="+e.folder._key;e.act_as_tree||(i=""),common.put(url+"datasets/"+t.datatype+"/orders/"+a.oldIndex+"/"+a.newIndex+i,{},function(){})}})}})})}),require.register("widgets/datatypes.html.tag",function(t,e,a){riot.tag2("datatype_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#datatypes/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#datatypes/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(t){common.get(url+"/cruds/folders/datatypes/"+t,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(t){var i=prompt("Folder's name");common.post(url+"/cruds/folders/datatypes",JSON.stringify({name:i,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(t){var a=prompt("Update Folder's name");common.patch(url+"/cruds/folders/datatypes",JSON.stringify({name:a,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(t){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var t=_.last(_.initial(e.path));common["delete"](url+"/cruds/folders/datatypes/"+e.folder._key,function(i){common.get(url+"/cruds/folders/datatypes/"+t._key,function(i){e.folders=i.folders,e.path=i.path,a(t._key),e.update()})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("datatype_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">datatypes</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing datatype</h3> <form onsubmit="{save_form}" class="uk-form" id="form_datatype"> </form> <dataset_helper></dataset_helper> <a class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this datatype... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_datatype","cruds/datatypes",t.datatype_id)}.bind(this),this.duplicate=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/datatypes/"+t.datatype_id+"/duplicate",function(t){route("/datatypes/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.publish=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/cruds/datatypes/"+t.datatype_id+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/cruds/datatypes/"+t.datatype_id,function(a){e.datatype=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields,o=a.fields.act_as_tree;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(s){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,s.role),e.loaded=!0,e.update();var l="datatypes";o&&(l="datatypes/"+e.datatype.folder_key),e.can_access&&common.buildForm(e.datatype,i,"#form_datatype",l,function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"datatype_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.datatype_id,parent_name:l})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("datatype_new",'<virtual if="{can_access}"> <h3>Creating datatype</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_datatype"> </form> <dataset_helper></dataset_helper> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this datatype... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_datatype","cruds/datatypes")}.bind(this),common.get(url+"/cruds/datatypes/fields",function(a){common.get(url+"/auth/whoami",function(i){if(e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var o=a.fields,s={};_.isArray(o)||(o=o.model);var l="datatypes";e.opts.folder_key&&(o.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),s.folder_key=t.folder_key,l="datatypes/"+t.folder_key),common.buildForm(s,o,"#form_new_datatype",l)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("datatypes",'<datatype_folders show="{loaded}" folder_key="{folder_key}"></datatype_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#datatypes/{folder._key}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New datatype</a> <a if="{!act_as_tree}" href="#datatypes/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New datatype</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing datatypes</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previouspage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextpage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setperpage}" class="uk-label">25</a> <a onclick="{setperpage}" class="uk-label">50</a> <a onclick="{setperpage}" class="uk-label">100</a> <a onclick="{setperpage}" class="uk-label">500</a> <a onclick="{setperpage}" class="uk-label">1000</a> <a onclick="{setperpage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this datatype... </virtual>',"","",function(t){
var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder={},this.folder_key=this.opts.folder_key||"",this.act_as_tree=!0,this.loaddatatype=function(t){e.loaded=!1;var a="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/cruds/datatypes/page/"+t+"/"+this.perpage+a,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.setFolder=function(t){e.folder=t,e.act_as_tree=""!==t,e.loaddatatype(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/datatypes/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loaddatatype(1)}.bind(this),this.edit=function(t){route("/datatypes/"+t.item.row._key+"/edit")}.bind(this),this.nextpage=function(t){e.page+=1,e.loaddatatype(e.page+1)}.bind(this),this.previouspage=function(t){e.page-=1,e.loaddatatype(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/datatypes/"+t.item.row._key,function(){e.loaddatatype(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/datatypes/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setperpage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loaddatatype(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/datatypes/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","datatypes.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){var a="?folder_key="+e.folder._key;e.act_as_tree||(a=""),common.put(url+"cruds/datatypes/orders/"+t.oldIndex+"/"+t.newIndex+a,{},function(){})}})}})}),riot.tag2("dataset_helper",'<hr> <h4>Data definition sample</h4> <pre><code class="json">\\{\n    "model": [\n      \\{ "r": true, "c": "1-1", "n": "title", "t": "string", "j": "joi.string().required()", "l": "Title", "tr": true \\},\n      \\{ "r": true, "c": "1-1", "n": "color", "t": "string:color", "j": "joi.string().required()", "l": "Pick a color"\\},\n      \\{ "r": true, "c": "1-1", "n": "position", "t": "integer", "j": "joi.number().integer()", "l": "Position" \\},\n      \\{ "r": true, "c": "1-1", "n": "online", "t": "boolean", "j": "joi.number().integer()", "l": "Online?" \\},\n      \\{ "r": true, "c": "1-1", "n": "published_at", "t": "date", "j": "joi.date().required()", "l": "Published_at" \\},\n      \\{ "r": true, "c": "1-1", "n": "time", "t": "time", "j": "joi.string()", "l": "Time" \\},\n      \\{ "r": true, "c": "1-1", "n": "desc", "t": "text", "j": "joi.string()", "l": "Description" \\},\n      \\{\n        "r": true, "c": "1-1", "n": "author_key", "t": "list", "j": "joi.string()", "l": "User",\n        "d": "d": "FOR doc IN datasets FILTER doc.type == \'authors\' RETURN [doc._key, CONCAT(doc.ln, \' \', doc.fn)]"\n      \\},\n      \\{ "r": true, "c": "1-1", "n": "image", "t": "image", "j": "joi.string()", "l": "Pictures" \\},\n      \\{ "r": true, "c": "1-1", "n": "file", "t": "file", "j": "joi.string()", "l": "Files" \\},\n      \\{\n        "r": true, "c": "1-1", "n": "tags", "t": "tags", "j": "joi.array()", "l": "Tags",\n        "d": "LET tags = (FOR doc IN datasets FILTER doc.type==\'books\' AND doc.tags != NULL RETURN doc.tags) RETURN UNIQUE(FLATTEN(tags))"\n      \\},\n      \\{ "r": true, "c": "1-1", "n": "items", "t": "multilist", "j": "joi.array()", "l": "Multi List of tags", "d": "AQL request" \\},\n      \\{ "r": true, "c": "1-1", "n": "position", "t": "map", "j": "joi.array()", "l": "Coordinates" \\},\n      \\{ "r": true, "c": "1-1", "n": "html", "t": "code:html", "j": "joi.any()", "l": "Some HTML" \\},\n      \\{ "r": true, "c": "1-1", "n": "scss", "t": "code:scss", "j": "joi.any()", "l": "Some SCSS" \\},\n      \\{ "r": true, "c": "1-1", "n": "javascript", "t": "code:javascript", "j": "joi.any()", "l": "Some JS" \\},\n      \\{ "r": true, "c": "1-1", "n": "json", "t": "code:json", "j": "joi.any()", "l": "Some Json" \\},\n      \\{ "r": true, "c": "1-1", "n": "content", "t": "html", "j": "joi.any()", "l": "Content Editor" \\}\n      \\{ "r": true, "c": "1-1", "n": "html_content", "t": "wysiwyg", "j": "joi.any()", "l": "Wysiwyg editor" \\}\n    ],\n    "columns": [\n      \\{ "name": "title", "tr": true, "class": "uk-text-right", "toggle": true,\n        "values": \\{ "true": "online", "false": "offline" \\},\n        "truncate": 20, "uppercase": true, "lowercase": true\n      \\}\n    ],\n    "act_as_tree": true,\n    "sortable": true,\n    "revisions": 10,\n    "publishable": true,\n    "slug": ["title"],\n    "sort": "SORT doc.order ASC",\n    "search": ["title", "barcode", "desc"],\n    "includes": \\{\n      "conditions": "FOR c IN customers FILTER c._key == doc.customer_key",\n      "merges": ", customer: c "\n    \\},\n    "timestamps": true\n  \\}\n  </code></pre>',"dataset_helper pre { padding: 0; border: none; border-radius: 4px; }","",function(t){})}),require.register("widgets/helpers.html.tag",function(t,e,a){riot.tag2("helper_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"helper_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"helper_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("helper_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_helper"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"helper_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_helper","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.helper=a.data,common.buildForm(e.helper,t.fields,"#"+t.id+"_crud_helper")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("helper_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_helper"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"helper_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_helper")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_helper","cruds/sub/helpers/"+t.id,"",t)}.bind(this)}),riot.tag2("helper_edit",'<virtual if="{can_access}"> <div uk-alert class="uk-alert-warning" if="{locked_by}"> <i class="fas fa-lock"></i> This file is locked by {locked_by} </div> <ul uk-tab> <li><a href="#">helpers</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing helper</h3> <form onsubmit="{save_form}" class="uk-form" id="form_helper"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.locked_by=null,this.save_form=function(e){e.preventDefault(),common.saveForm("form_helper","cruds/helpers",t.helper_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/helpers/"+e.helper._key+"/duplicate",function(t){route("/helpers/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/helpers/"+t.helper_id,function(a){e.helper=a.data,e.locked_by=a.data.locked_by,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.helper,i,"#form_helper","helpers",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"helper_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.helper_id,parent_name:"helpers"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("helper_new",'<virtual if="{can_access}"> <h3>Creating helper</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_helper"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_helper","cruds/helpers")}.bind(this),common.get(url+"/cruds/helpers/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_helper","helpers")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("helpers",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#helpers/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New helper</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing helpers</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/helpers/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/helpers/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/helpers/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/helpers/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/helpers/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/helpers/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","helpers.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/helpers/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/layouts.html.tag",function(t,e,a){riot.tag2("layout_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"layout_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"layout_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("layout_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_layout"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"layout_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_layout","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.layout=a.data,common.buildForm(e.layout,t.fields,"#"+t.id+"_crud_layout")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("layout_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_layout"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"layout_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_layout")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_layout","cruds/sub/layouts/"+t.id,"",t)}.bind(this)}),riot.tag2("layout_edit",'<virtual if="{can_access}"> <div uk-alert class="uk-alert-warning" if="{locked_by}"> <i class="fas fa-lock"></i> This file is locked by {locked_by} </div> <ul uk-tab> <li><a href="#">layouts</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing layout</h3> <form onsubmit="{save_form}" class="uk-form" id="form_layout"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.locked_by=null,this.save_form=function(e){e.preventDefault(),common.saveForm("form_layout","cruds/layouts",t.layout_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/layouts/"+e.layout._key+"/duplicate",function(t){route("/layouts/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/layouts/"+t.layout_id,function(a){e.layout=a.data,e.locked_by=a.data.locked_by,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.layout,i,"#form_layout","layouts",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"layout_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.layout_id,parent_name:"layouts"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("layout_new",'<virtual if="{can_access}"> <h3>Creating layout</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_layout"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_layout","cruds/layouts")}.bind(this),common.get(url+"/cruds/layouts/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_layout","layouts")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("layouts",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#layouts/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New layout</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing layouts</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/layouts/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/layouts/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/layouts/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/layouts/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/layouts/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/layouts/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","layouts.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/layouts/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/loading.html.tag",function(t,e,a){riot.tag2("loading",'<div class="uk-text-center"> Loading app ... <br><div uk-spinner></div> </div>',"","",function(t){common.get(url+"auth/whoami",function(t){null===t.username?document.location.href="login.html":(localStorage.setItem("resize_api_key",t.resize_api_key),route("/welcome"))})}),riot.tag2("welcome",'<h1 class="uk-text-center">Welcome aboard</h1> <p class="uk-text-center" style="color: white">This is a landing page ... Nothing special here, replace it by what you want !</p> <p class="uk-text-center" style="color: white">Find me in <code>app/widgets/loading.html.tag</code></p> <h2 class="uk-text-center" style="margin-top:80px"><a href="https://fasty.ovh" target="_blank">Fasty</a> is powered by powerful opensource projects</h2> <div class="uk-container uk-text-center" style="color: white;margin-top:80px"> <div class="uk-column-1-2"> <div class="uk-margin"> <a href="https://www.arangodb.com/" target="_blank"><img src="/static/admin/img/ArangoDB-logo-bg.svg" style="height:90px"></a> <br>ArangoDB </div> <div class="uk-margin"> <a href="https://openresty.org/en/" target="_blank"><img src="/static/admin/img/logo.png" style="height:90px"></a> <br>openresty </div> </div> <div class="uk-column-1-2"> <div class="uk-margin"> <a href="https://riot.js.org/" target="_blank"><img src="/static/admin/img/square.svg" style="height:90px"></a> <br>RiotJS </div> <div class="uk-margin"> <a href="https://leafo.net/lapis/" target="_blank"><img src="/static/admin/img/lapis.jpg" style="height:90px"></a> <br>LAPIS </div> </div> </div> </div>',"","",function(t){}),riot.tag2("rightnav",'<ul class="uk-navbar-nav"> <li><a onclick="{deploy}" if="{settings.deploy_secret != ⁗⁗}">Deploy</a></li> <li each="{lang in langs}" class="{lang == window.localStorage.getItem(\'foxx-locale\') ? \'uk-active\' : \'\'}"><a onclick="{changeLang}">{lang}</a></li> <li><a href="#logout"><i class="uk-icon-sign-out"></i> Logout</a></li> </ul>',"","",function(t){
this.settings={};var e=this;common.get(url+"/settings",function(t){e.settings=t.data,e.langs=e.settings.langs.split(","),e.update()}),this.changeLang=function(t){window.localStorage.setItem("foxx-locale",t.item.lang),document.location.reload()}.bind(this),this.deploy=function(t){if(t.preventDefault(),confirm("Are you sure?")){var a="/deploy";$.post(a,{token:e.settings.token},function(t){"site deployed"==t&&UIkit.notification({message:"Site Deployed Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})})}return!1}.bind(this)})}),require.register("widgets/login.html.tag",function(t,e,a){riot.tag2("loading",'<div class="uk-text-center"> Loading app ... <br><div uk-spinner></div> </div>',"","",function(t){route("/login")}),riot.tag2("login",'<div class="uk-container uk-container-center"> <div uk-grid class="uk-grid-small uk-child-width-1-3@s uk-flex-center uk-text-center"> <div> <h1 class="uk-margin-large-top"><i class="uk-icon-sign-in"></i> Connection</h1> <form class="uk-form uk-margin-top" onsubmit="{save_form}"> <div class="uk-margin"> <input placeholder="Email" class="uk-input" id="username" name="username" value="" type="email"> </div> <div class="uk-margin"> <input type="password" class="uk-input" placeholder="Mot de passe" class="uk-input" id="password" name="password" value=""> </div> <hr> <div class="uk-margin"> <button type="submit" class="uk-button uk-button-primary">Connection</button> </div> <div class="uk-margin-small"> <div id="login_error" class="uk-alert uk-alert-danger uk-hidden uk-text-center"> Bad login or password </div> </div> </form> </div> </div> </div>',"","",function(t){this.save_form=function(t){t.preventDefault(),common.post(url+"auth/login",JSON.stringify({username:$("#username").val(),password:$("#password").val()}),function(t){t.success?document.location.href="index.html":$("#login_error").removeClass("uk-hidden")})}.bind(this)})}),require.register("widgets/pages.html.tag",function(t,e,a){riot.tag2("page_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#pages/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#pages/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(t){common.get(url+"/cruds/folders/pages/"+t,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(t){var i=prompt("Folder's name");common.post(url+"/cruds/folders/pages",JSON.stringify({name:i,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(t){var a=prompt("Update Folder's name");common.patch(url+"/cruds/folders/pages",JSON.stringify({name:a,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(t){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var t=_.last(_.initial(e.path));common["delete"](url+"/cruds/folders/pages/"+e.folder._key,function(i){common.get(url+"/cruds/folders/pages/"+t._key,function(i){e.folders=i.folders,e.path=i.path,a(t._key),e.update()})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("page_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"page_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"page_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("page_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_page"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"page_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_page","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.page=a.data,common.buildForm(e.page,t.fields,"#"+t.id+"_crud_page")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("page_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_page"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"page_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_page")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_page","cruds/sub/pages/"+t.id,"",t)}.bind(this)}),riot.tag2("page_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">pages</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing page</h3> <form onsubmit="{save_form}" class="uk-form" id="form_page"> </form> <a class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}">Sorry, you can\'t access this page...</virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_page","cruds/pages",t.page_id)}.bind(this),this.duplicate=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/pages/"+t.page_id+"/duplicate",function(t){route("/pages/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.publish=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/cruds/pages/"+t.page_id+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/cruds/pages/"+t.page_id,function(a){e.page=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields,o=a.fields.act_as_tree;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(s){localStorage.setItem("resize_api_key",s.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,s.role),e.loaded=!0,e.update();var l="pages";o&&(l="pages/"+e.page.folder_key),e.can_access&&common.buildForm(e.page,i,"#form_page",l,function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"page_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.page_id,parent_name:l})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("page_new",'<virtual if="{can_access}"> <h3>Creating page</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_page"> </form> </virtual> <virtual if="{!can_access && loaded}">Sorry, you can\'t access this page...</virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_page","cruds/pages")}.bind(this),common.get(url+"/cruds/pages/fields",function(a){common.get(url+"/auth/whoami",function(i){if(localStorage.setItem("resize_api_key",i.resize_api_key),e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var o=a.fields,s={};_.isArray(o)||(o=o.model);var l="pages";e.opts.folder_key&&(o.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),s.folder_key=t.folder_key,l="pages/"+t.folder_key),common.buildForm(s,o,"#form_new_page",l)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("pages",'<page_folders show="{loaded}" folder_key="{folder_key}"></page_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#pages/{folder._key}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New page</a> <a if="{!act_as_tree}" href="#pages/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New page</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing pages</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}">Sorry, you can\'t access this page...</virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder={},this.folder_key=this.opts.folder_key||"",this.act_as_tree=!0,this.loadPage=function(t){e.loaded=!1;var a="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/cruds/pages/page/"+t+"/"+this.perpage+a,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){localStorage.setItem("resize_api_key",a.resize_api_key),e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.setFolder=function(t){e.folder=t,e.act_as_tree=""!==t,e.loadPage(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/pages/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/pages/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/pages/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/pages/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/pages/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","pages.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){var a="?folder_key="+e.folder._key;e.act_as_tree||(a=""),common.put(url+"cruds/pages/orders/"+t.oldIndex+"/"+t.newIndex+a,{},function(){})}})}})})}),require.register("widgets/partials.html.tag",function(t,e,a){riot.tag2("partial_folders",'<div> <ul class="uk-breadcrumb"> <li each="{f in path}"><a href="#partials/{f._key}">{f.name}</a></li> <li> <a if="{path.length > 1}" onclick="{renameFolder}"><i class="far fa-edit"></i></a> <a onclick="{addFolder}"><i class="fas fa-plus"></i></a> <a if="{path.length > 1 && folders.length == 0}" onclick="{deleteFolder}"><i class="fas fa-trash"></i></a> </li> </ul> <ul class="uk-list"> <li each="{f in folders}"><a href="#partials/{f._key}"><i class="far fa-folder"></i> {f.name}</a></li> </ul> </div>',"","",function(t){this.folders=[],this.folder={},this.path=[this.folder],this.folder_key=this.opts.folder_key||"";var e=this,a=function(t){common.get(url+"/cruds/folders/partials/"+t,function(t){e.folders=t.folders,e.path=t.path,e.folder=_.last(e.path),e.parent.setFolder(e.folder),e.update()})};this.addFolder=function(t){var i=prompt("Folder's name");common.post(url+"/cruds/folders/partials",JSON.stringify({name:i,parent_id:e.folder._key}),function(t){a(e.folder._key)})}.bind(this),this.renameFolder=function(t){var a=prompt("Update Folder's name");common.patch(url+"/cruds/folders/partials",JSON.stringify({name:a,id:e.folder._key}),function(t){e.path=t.path,e.update()})}.bind(this),this.deleteFolder=function(t){UIkit.modal.confirm("Are you sure? This action will destroy the folder and it's content").then(function(){var t=_.last(_.initial(e.path));common["delete"](url+"/cruds/folders/partials/"+e.folder._key,function(i){common.get(url+"/cruds/folders/partials/"+t._key,function(i){e.folders=i.folders,e.path=i.path,a(t._key),e.update()})})},function(){console.log("Rejected.")})}.bind(this),a(this.folder_key)}),riot.tag2("partial_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{partial > 0}"><a onclick="{previouspage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(partial + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextpage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"partial_crud_new",t)}.bind(this),this.loadpartial=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/partial/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadpartial(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"partial_crud_edit",t)}.bind(this),this.nextpage=function(t){t.preventDefault(),e.partial+=1,e.loadpartial(e.partial+1)}.bind(this),this.previouspage=function(t){t.preventDefault(),e.partial-=1,e.loadpartial(e.partial+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadpartial(1)})},function(){})}.bind(this)}),riot.tag2("partial_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_partial"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"partial_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_partial","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.partial=a.data,common.buildForm(e.partial,t.fields,"#"+t.id+"_crud_partial")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("partial_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_partial"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"partial_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_partial")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_partial","cruds/sub/partials/"+t.id,"",t)}.bind(this)}),riot.tag2("partial_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">partials</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing partial</h3> <form onsubmit="{save_form}" class="uk-form" id="form_partial"> </form> <a class="uk-button uk-button-primary" onclick="{publish}">Publish</a> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}">Sorry, you can\'t access this partial...</virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_partial","cruds/partials",t.partial_id)}.bind(this),this.duplicate=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/partials/"+t.partial_id+"/duplicate",function(t){route("/partials/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),this.publish=function(e){UIkit.modal.confirm("Are you sure?").then(function(){common.post(url+"/cruds/partials/"+t.partial_id+"/publish",JSON.stringify({}),function(t){UIkit.notification({message:"Successfully published!",status:"success",timeout:1e3,pos:"bottom-right"})})})}.bind(this),common.get(url+"/cruds/partials/"+t.partial_id,function(a){e.partial=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields,o=a.fields.act_as_tree;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(s){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,s.role),e.loaded=!0,e.update();var l="partials";o&&(l="partials/"+e.partial.folder_key),e.can_access&&common.buildForm(e.partial,i,"#form_partial",l,function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"partial_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.partial_id,parent_name:l})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("partial_new",'<virtual if="{can_access}"> <h3>Creating partial</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_partial"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this partial... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_partial","cruds/partials")}.bind(this),common.get(url+"/cruds/partials/fields",function(a){common.get(url+"/auth/whoami",function(i){if(e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,i.role),e.loaded=!0,e.update(),e.can_access){var o=a.fields,s={};_.isArray(o)||(o=o.model);var l="partials";e.opts.folder_key&&(o.push({r:!0,c:"1-1",n:"folder_key",t:"hidden"}),s.folder_key=t.folder_key,l="partials/"+t.folder_key),common.buildForm(s,o,"#form_new_partial",l)}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("partials",'<partial_folders show="{loaded}" folder_key="{folder_key}"></partial_folders> <virtual if="{can_access}"> <div class="uk-float-right"> <a if="{act_as_tree}" href="#partials/{folder._key}/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New partial</a> <a if="{!act_as_tree}" href="#partials/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New partial</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing partials</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{partial > 0}"><a onclick="{previouspage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(partial + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextpage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per partial : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setperpage}" class="uk-label">25</a> <a onclick="{setperpage}" class="uk-label">50</a> <a onclick="{setperpage}" class="uk-label">100</a> <a onclick="{setperpage}" class="uk-label">500</a> <a onclick="{setperpage}" class="uk-label">1000</a> <a onclick="{setperpage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this partial... </virtual>',"","",function(t){var e=this;this.partial=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.folder={},this.folder_key=this.opts.folder_key||"",this.act_as_tree=!0,this.loadpartial=function(t){e.loaded=!1;var a="?folder="+e.folder._key+"&is_root="+e.folder.is_root;common.get(url+"/cruds/partials/page/"+t+"/"+this.perpage+a,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.setFolder=function(t){e.folder=t,e.act_as_tree=""!==t,e.loadpartial(1)},this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/partials/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadpartial(1)}.bind(this),this.edit=function(t){route("/partials/"+t.item.row._key+"/edit")}.bind(this),this.nextpage=function(t){e.partial+=1,e.loadpartial(e.partial+1)}.bind(this),this.previouspage=function(t){e.partial-=1,e.loadpartial(e.partial+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/partials/"+t.item.row._key,function(){e.loadpartial(e.partial+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/partials/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setperpage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadpartial(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/partials/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","partials.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){var a="?folder_key="+e.folder._key;e.act_as_tree||(a=""),common.put(url+"cruds/partials/orders/"+t.oldIndex+"/"+t.newIndex+a,{},function(){})}})}})})}),require.register("widgets/redirections.html.tag",function(t,e,a){riot.tag2("redirection_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){
var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"redirection_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"redirection_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("redirection_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_redirection"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"redirection_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_redirection","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.redirection=a.data,common.buildForm(e.redirection,t.fields,"#"+t.id+"_crud_redirection")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("redirection_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_redirection"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"redirection_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_redirection")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_redirection","cruds/sub/redirections/"+t.id,"",t)}.bind(this)}),riot.tag2("redirection_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">redirections</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing redirection</h3> <form onsubmit="{save_form}" class="uk-form" id="form_redirection"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this redirection... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_redirection","cruds/redirections",t.redirection_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/redirections/"+e.redirection._key+"/duplicate",function(t){route("/redirections/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/redirections/"+t.redirection_id,function(a){e.redirection=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.redirection,i,"#form_redirection","redirections",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"redirection_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.redirection_id,parent_name:"redirections"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("redirection_new",'<virtual if="{can_access}"> <h3>Creating redirection</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_redirection"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this redirection... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_redirection","cruds/redirections")}.bind(this),common.get(url+"/cruds/redirections/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_redirection","redirections")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("redirections",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#redirections/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New redirection</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing redirections</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/redirections/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/redirections/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/redirections/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/redirections/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/redirections/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/redirections/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","redirections.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/redirections/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/scripts.html.tag",function(t,e,a){riot.tag2("script_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"script_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/"+t.parent_name+"/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"script_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("script_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_script"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"script_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_script","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.script=a.data,common.buildForm(e.script,t.fields,"#"+t.id+"_crud_script")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("script_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_script"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"script_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_script")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_script","cruds/sub/scripts/"+t.id,"",t)}.bind(this)}),riot.tag2("script_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">scripts</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing script</h3> <form onsubmit="{save_form}" class="uk-form" id="form_script"> </form> <a class="uk-button uk-button-secondary" onclick="{install}">Launch / Restart</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.settings={},e.locked_by=null,common.get(url+"/settings",function(t){e.settings=t.data}),this.save_form=function(e){e.preventDefault(),common.saveForm("form_script","cruds/scripts",t.script_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/scripts/"+e.script._key+"/duplicate",function(t){route("/scripts/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/scripts/"+t.script_id,function(a){e.script=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.script,i,"#form_script","scripts",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"script_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.script_id,parent_name:"scripts"})})})})}),this.install=function(t){t.preventDefault();var a="/script/"+e.script.name;return $.post(a,{token:e.settings.token},function(t){"script installed"==t&&UIkit.notification({message:"Script Launched Successfully!",status:"success",timeout:1e3,pos:"bottom-right"})}),!1}.bind(this),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("script_new",'<virtual if="{can_access}"> <h3>Creating script</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_script"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_script","cruds/scripts")}.bind(this),common.get(url+"/cruds/scripts/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_script","scripts")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("scripts",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#scripts/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New script</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing scripts</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/scripts/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/scripts/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/scripts/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/scripts/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/scripts/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/scripts/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","scripts.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/scripts/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/settings.html.tag",function(t,e,a){riot.tag2("settings",'<h3 if="{can_access}">settings</h3> <form onsubmit="{save_form}" id="form_settings"> </form> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.can_access=!1,this.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_settings","settings",a.obj._key)}.bind(this);var a=this;common.get(url+"settings/",function(t){a.obj=t.data,common.get(url+"/auth/whoami",function(i){e.update(),e.loaded=!0,e.can_access=void 0===t.roles||_.includes(t.roles.write,i.role),e.can_access&&common.buildForm(a.obj,t.fields,"#form_settings"),e.update()})}),this.on("updated",function(){$(".select_list").select2(),$(".select_tag").select2({tags:!0})})})}),require.register("widgets/spas.html.tag",function(t,e,a){riot.tag2("spa_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"spa_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"spa_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("spa_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_spa"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"spa_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_spa","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.spa=a.data,common.buildForm(e.spa,t.fields,"#"+t.id+"_crud_spa")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("spa_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_spa"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"spa_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_spa")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_spa","cruds/sub/spas/"+t.id,"",t)}.bind(this)}),riot.tag2("spa_edit",'<virtual if="{can_access}"> <div uk-alert class="uk-alert-warning" if="{locked_by}"> <i class="fas fa-lock"></i> This file is locked by {locked_by} </div> <ul uk-tab> <li><a href="#">spas</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing spa</h3> <form onsubmit="{save_form}" class="uk-form" id="form_spa"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,e.locked_by=null,this.save_form=function(e){e.preventDefault(),common.saveForm("form_spa","cruds/spas",t.spa_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/spas/"+e.spa._key+"/duplicate",function(t){route("/spas/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/spas/"+t.spa_id,function(a){e.spa=a.data,e.locked_by=a.data.locked_by,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.spa,i,"#form_spa","spas",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"spa_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.spa_id,parent_name:"spas"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("spa_new",'<virtual if="{can_access}"> <h3>Creating spa</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_spa"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_spa","cruds/spas")}.bind(this),common.get(url+"/cruds/spas/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_spa","spas")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("spas",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#spas/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New spa</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing spas</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){
var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/spas/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/spas/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/spas/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/spas/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/spas/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/spas/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","spas.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/spas/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/trads.html.tag",function(t,e,a){riot.tag2("trad_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"trad_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"trad_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("trad_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_trad"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"trad_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_trad","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.trad=a.data,common.buildForm(e.trad,t.fields,"#"+t.id+"_crud_trad")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("trad_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_trad"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"trad_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_trad")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_trad","cruds/sub/trads/"+t.id,"",t)}.bind(this)}),riot.tag2("trad_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">trads</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing trad</h3> <form onsubmit="{save_form}" class="uk-form" id="form_trad"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_trad","cruds/trads",t.trad_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/trads/"+e.trad._key+"/duplicate",function(t){route("/trads/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/trads/"+t.trad_id,function(a){e.trad=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.trad,i,"#form_trad","trads",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"trad_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.trad_id,parent_name:"trads"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("trad_new",'<virtual if="{can_access}"> <h3>Creating trad</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_trad"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_trad","cruds/trads")}.bind(this),common.get(url+"/cruds/trads/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_trad","trads")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("trads",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#trads/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New trad</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing trads</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/trads/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/trads/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/trads/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/trads/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/trads/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/trads/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","trads.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/trads/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.register("widgets/uploads.html.tag",function(t,e,a){riot.tag2("images",'<div class="sortable_{opts.field}" style="user-select: none;" uk-sortable="group: upload"> <virtual each="{row in data}"> <div uk-grid class="uk-grid-small" data-id="{row._key}"> <div class="uk-width-1-5"><a href="{row.url}" target="_blank"><img riot-src="{row.url}?_from={from}" alt="" style="max-width: 100%"></a></div> <div class="uk-width-3-5">{row.filename.split(\'/\')[row.filename.split(\'/\').length - 1]}<br>{prettyBytes(row.length)}</div> <div class="uk-width-1-5 uk-text-center"><a onclick="{delete_asset}" uk-icon="icon: trash"></a></div> </div> </virtual> </div>',"images div, images span { color: white; }","",function(t){var e=this;this.from=btoa(subdomain),this.data=[];var a="";"undefined"!=t.i18n&&(a="/"+window.localStorage.getItem("foxx-locale")),this.load=function(){common.get(url+"uploads/"+t.id+"/"+t.field+a,function(t){e.data=t,e.update()})}.bind(this),this.load(),$(function(){UIkit.util.on(".sortable_"+t.field,"moved",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i,field:t.field}),function(t){t.success&&UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"})})}),UIkit.util.on(".sortable_"+t.field,"added",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i,field:t.field}),function(t){t.success&&(eventHub.trigger("refresh_uploads"),UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"}))})})}),eventHub.on("refresh_uploads",function(){e.load()}),this.delete_asset=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"uploads/"+t.item.row._key,function(){$("[data-id="+t.item.row._key+"]").remove()})},function(){})}.bind(this)}),riot.tag2("files",'<div class="sortable_{opts.field}" style="user-select: none;"> <virtual each="{row in data}"> <div uk-grid class="uk-grid-small" data-id="{row._key}"> <div class="uk-width-3-5">{row.filename} <a href="{row.url}?_from={from}" target="_blank"><i class="fas fa-external-link-alt"></i></a></div> <div class="uk-width-1-5 uk-text-right">{prettyBytes(row.length)}</div> <div class="uk-width-1-5 uk-text-center"><a onclick="{delete_asset}" uk-icon="icon: trash"></a></div> </div> </div>',"files div, files span { color: white; }","",function(t){var e=this;this.from=btoa(subdomain),this.data=[];var a="";"undefined"!=t.i18n&&(a="/"+window.localStorage.getItem("foxx-locale")),common.get(url+"uploads/"+t.id+"/"+t.field+a,function(t){e.data=t,e.update()}),this.filename=function(t){return t.path.split("/").slice(2).join("/")}.bind(this),$(function(){UIkit.sortable(".sortable_"+t.field,{}),UIkit.util.on(".sortable_"+t.field,"moved",function(e){var a=0,i=_.map($(".sortable_"+t.field+" > div"),function(t){return{k:""+$(t).data("id"),c:a++}});common.post(url+"uploads/reorder",JSON.stringify({ids:i}),function(t){t.success&&UIkit.notification({message:"Successfully reordered!",status:"success",timeout:1e3,pos:"bottom-right"})})})}),this.delete_asset=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"uploads/"+t.item.row._key,function(){$("[data-id="+t.item.row._key+"]").remove()})},function(){})}.bind(this)})}),require.register("widgets/users.html.tag",function(t,e,a){riot.tag2("user_crud_index",'<a href="#" class="uk-button uk-button-small uk-button-default" onclick="{new_item}"> <i class="fas fa-plus"></i> New {opts.singular} </a> <table class="uk-table uk-table-striped" if="{data.length > 0}"> <thead> <tr> <th each="{col in cols}"> {col.name == undefined ? col : col.label === undefined ? col.name : col.label} </th> <th width="70"></th> </tr> </thead> <tbody> <tr each="{row in data}"> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.tr == true}">{_.get(row,col.name)[locale]}</virtual> <virtual if="{col.tr != true}">{_.get(row,col.name)}</virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul>',"","",function(t){var e=this;this.data=[],this.new_item=function(e){e.preventDefault(),riot.mount("#"+t.id,"user_crud_new",t)}.bind(this),this.loadPage=function(a){common.get(url+"/cruds/sub/"+t.parent_id+"/"+t.id+"/"+t.key+"/page/"+a+"/"+per_page,function(a){e.data=a.data[0].data,e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.columns&&(e.cols=t.columns),e.count=a.data[0].count,e.update()})},this.loadPage(1),this.edit=function(e){e.preventDefault(),t.element_id=e.item.row._key,riot.mount("#"+t.id,"user_crud_edit",t)}.bind(this),this.nextPage=function(t){t.preventDefault(),e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){t.preventDefault(),e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(a){a.preventDefault(),UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/"+t.id+"/"+a.item.row._key,function(){e.loadPage(1)})},function(){})}.bind(this)}),riot.tag2("user_crud_edit",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_user"> </form>',"","",function(t){this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"user_crud_index",t)}.bind(this),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_user","cruds/sub/"+t.parent_name+"/"+t.id+"/"+t.element_id,"",t)}.bind(this);var e=this;common.get(url+"/cruds/"+t.id+"/"+t.element_id,function(a){e.user=a.data,common.buildForm(e.user,t.fields,"#"+t.id+"_crud_user")}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("user_crud_new",'<a href="#" class="uk-button uk-button-link" onclick="{goback}">Back to {opts.id}</a> <form onsubmit="{save_form}" class="uk-form" id="{opts.id}_crud_user"> </form>',"","",function(t){var e=this;this.crud={},this.crud[t.key]=t.parent_id,this.goback=function(e){e.preventDefault(),riot.mount("#"+t.id,"user_crud_index",t)}.bind(this),this.on("mount",function(){common.buildForm(e.crud,t.fields,"#"+t.id+"_crud_user")}),this.save_form=function(e){e.preventDefault(),common.saveForm(t.id+"_crud_user","cruds/sub/users/"+t.id,"",t)}.bind(this)}),riot.tag2("user_edit",'<virtual if="{can_access}"> <ul uk-tab> <li><a href="#">users</a></li> <li each="{i, k in sub_models}"><a href="#">{k}</a></li> </ul> <ul class="uk-switcher uk-margin"> <li> <h3>Editing user</h3> <form onsubmit="{save_form}" class="uk-form" id="form_user"> </form> <a class="uk-button uk-button-secondary" onclick="{duplicate}">Duplicate</a> </li> <li each="{i, k in sub_models}"> <div id="{k}" class="crud"></div> </li> </ul> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual> <script>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(e){e.preventDefault(),common.saveForm("form_user","cruds/users",t.user_id)}.bind(this),this.duplicate=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common.get(url+"/cruds/users/"+e.user._key+"/duplicate",function(t){route("/users/"+t._key+"/edit"),UIkit.notification({message:"Successfully duplicated!",status:"success",timeout:1e3,pos:"bottom-right"})})},function(){})}.bind(this),common.get(url+"/cruds/users/"+t.user_id,function(a){e.user=a.data,e.fields=a.fields,e.sub_models=a.fields.sub_models;var i=a.fields;_.isArray(i)||(i=i.model),common.get(url+"/auth/whoami",function(o){e.can_access=void 0===a.fields.roles||_.includes(a.fields.roles.write,o.role),e.loaded=!0,e.update(),e.can_access&&common.buildForm(e.user,i,"#form_user","users",function(){$(".crud").each(function(a,i){var o=$(i).attr("id");riot.mount("#"+o,"user_crud_index",{model:o,fields:e.sub_models[o].fields,key:e.sub_models[o].key,singular:e.sub_models[o].singular,columns:e.sub_models[o].columns,parent_id:t.user_id,parent_name:"users"})})})})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("user_new",'<virtual if="{can_access}"> <h3>Creating user</h3> <form onsubmit="{save_form}" class="uk-form" id="form_new_user"> </form> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;e.can_access=!1,e.loaded=!1,this.save_form=function(t){t.preventDefault(),common.saveForm("form_new_user","cruds/users")}.bind(this),common.get(url+"/cruds/users/fields",function(t){common.get(url+"/auth/whoami",function(a){if(e.can_access=void 0===t.fields.roles||_.includes(t.fields.roles.write,a.role),e.loaded=!0,e.update(),e.can_access){var i=t.fields;_.isArray(i)||(i=i.model),common.buildForm({},i,"#form_new_user","users")}})}),this.on("updated",function(){$(".select_list").select2(),$(".select_mlist").select2(),$(".select_tag").select2({tags:!0})})}),riot.tag2("users",'<virtual if="{can_access}"> <div class="uk-float-right"> <a href="#users/new" class="uk-button uk-button-small uk-button-default"><i class="fas fa-plus"></i> New user</a> <a if="{export}" onclick="{export_data}" class="uk-button uk-button-small uk-button-primary"><i class="fas fa-file-export"></i> Export CSV</a> </div> <h3>Listing users</h3> <form onsubmit="{filter}" class="uk-margin-top"> <div class="uk-inline uk-width-1-1"> <span class="uk-form-icon" uk-icon="icon: search"></span> <input type="text" ref="term" id="term" class="uk-input" autocomplete="off"> </div> </form> <table class="uk-table uk-table-striped"> <thead> <tr> <th if="{sortable}" width="20"></th> <th each="{col in cols}">{col.name == undefined ? col : col.label === undefined ? col.name : col.label}</th> <th width="70"></th> </tr> </thead> <tbody id="list"> <tr each="{row in data}"> <td if="{sortable}"><i class="fas fa-grip-vertical handle"></i></td> <td each="{col in cols}" class="{col.class}"> <virtual if="{col.toggle == true}"> <virtual if="{col.tr == true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name][locale]] : _.get(row,col.name)[locale]}</a></virtual> <virtual if="{col.tr != true}"><a onclick="{toggleField}" data-key="{row._key}">{col.values ? col.values[row[col.name]] : _.get(row,col.name)}</a></virtual> </virtual> <virtual if="{col.toggle != true}"> <virtual if="{col.type == ⁗image⁗}"> <img riot-src="{_.get(row,col.name)[locale]} " style="height:25px"> </virtual> <virtual if="{col.type != ⁗image⁗}"> {calc_value(row, col, locale)} </virtual> </virtual> </td> <td class="uk-text-center" width="110"> <a onclick="{edit}" class="uk-button uk-button-primary uk-button-small"><i class="fas fa-edit"></i></a> <a onclick="{destroy_object}" class="uk-button uk-button-danger uk-button-small"><i class="fas fa-trash-alt"></i></a> </td> </tr> </tbody> </table> <ul class="uk-pagination"> <li if="{page > 0}"><a onclick="{previousPage}"><span class="uk-margin-small-right" uk-pagination-previous></span> Previous</a></li> <li if="{(page + 1) * perpage < count}" class="uk-margin-auto-left"><a onclick="{nextPage}">Next <span class="uk-margin-small-left" uk-pagination-next></span></a></li> </ul> Per Page : {perpage > 100000 ? \'ALL\' : perpage} <a onclick="{setPerPage}" class="uk-label">25</a> <a onclick="{setPerPage}" class="uk-label">50</a> <a onclick="{setPerPage}" class="uk-label">100</a> <a onclick="{setPerPage}" class="uk-label">500</a> <a onclick="{setPerPage}" class="uk-label">1000</a> <a onclick="{setPerPage}" class="uk-label">ALL</a> </virtual> <virtual if="{!can_access && loaded}"> Sorry, you can\'t access this page... </virtual>',"","",function(t){var e=this;this.page=0,this.perpage=localStorage.getItem("perpage")||per_page,this.locale=window.localStorage.getItem("foxx-locale"),this.data=[],this["export"]=!1,this.can_access=!1,this.sortable=!1,this.loaded=!1,this.loadPage=function(t){e.loaded=!1,common.get(url+"/cruds/users/page/"+t+"/"+this.perpage,function(t){e.data=t.data[0].data,e["export"]=!!t.model["export"],e.cols=_.map(common.array_diff(common.keys(e.data[0]),["_id","_key","_rev"]),function(t){return{name:t}}),t.model.columns&&(e.cols=t.model.columns),e.count=t.data[0].count,e.sortable=!!t.model.sortable,common.get(url+"/auth/whoami",function(a){e.loaded=!0,e.can_access=void 0===t.model.roles||_.includes(t.model.roles.read,a.role),e.update()})})},this.loadPage(1),this.calc_value=function(t,e,a){return value=_.get(t,e.name),e.tr&&(value=value[a]),e.truncate&&(value=value.substring(0,e.truncate)),e.capitalize&&(value=_.capitalize(value)),e.uppercase&&(value=_.toUpper(value)),e.downcase&&(value=_.toLower(value)),value}.bind(this),this.filter=function(t){t.preventDefault(),""!=e.refs.term.value?($(".uk-form-icon i").attr("class","uk-icon-spin uk-icon-spinner"),common.get(url+"/cruds/users/search/"+e.refs.term.value,function(t){e.data=t.data,$(".uk-form-icon i").attr("class","uk-icon-search"),e.update()})):e.loadPage(1)}.bind(this),this.edit=function(t){route("/users/"+t.item.row._key+"/edit")}.bind(this),this.nextPage=function(t){e.page+=1,e.loadPage(e.page+1)}.bind(this),this.previousPage=function(t){e.page-=1,e.loadPage(e.page+1)}.bind(this),this.destroy_object=function(t){UIkit.modal.confirm("Are you sure?").then(function(){common["delete"](url+"/cruds/users/"+t.item.row._key,function(){e.loadPage(e.page+1)})},function(){})}.bind(this),this.toggleField=function(t){t.preventDefault(),common.patch(url+"/cruds/users/"+t.target.dataset.key+"/"+t.item.col.name+"/toggle","{}",function(e){e.success&&(t.target.innerText=e.data)})}.bind(this),this.setPerPage=function(t){t.preventDefault();var e=parseInt(t.srcElement.innerText);localStorage.setItem("perpage",e),"ALL"==t.srcElement.innerText&&(e=1e9),this.perpage=e,this.loadPage(1)}.bind(this),this.export_data=function(t){common.get(url+"/cruds/users/export",function(t){var e=t.data,a=encodeURI(e),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download","users.csv"),i.innerHTML="Click Here to download",document.body.appendChild(i),i.click(),document.body.removeChild(i)})}.bind(this),this.on("updated",function(){if(e.sortable){var t=document.getElementById("list");new Sortable(t,{animation:150,ghostClass:"blue-background-class",handle:".fa-grip-vertical",onSort:function(t){common.put(url+"cruds/users/orders/"+t.oldIndex+"/"+t.newIndex,{},function(){})}})}})})}),require.alias("process/browser.js","process"),t=require("process"),require.register("___globals___",function(t,e,a){window.$=e("jquery"),window.jQuery=e("jquery"),window.riot=e("riot"),window.route=e("riot-route"),window.prettyBytes=e("pretty-bytes")})}(),require("___globals___");